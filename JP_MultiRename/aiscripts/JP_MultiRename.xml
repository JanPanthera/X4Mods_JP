<?xml version="1.0" encoding="utf-8"?>

<aiscript name="JP_MultiRename" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="aiscripts.xsd">

  <order id="JP_MultiRename" name="{8888888, 1197}MultiRename{8888888, 1199}" category="navigation" infinite="true">
    <params>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- How should "class" "model" and "type" be arranged -->
      <param name="NAMING_VARINAT" text="{8888888, 1101}" comment="Naming variant" type="number" default="if global.$NamingVariantMR? then global.$NamingVariantMR else 2">
        <input_param name="startvalue" value="2"/>
        <input_param name="min" value="1"/>
        <input_param name="max" value="6"/>
        <input_param name="step" value="1"/>
      </param>
      <!-- How should the generated name look like -->
      <param name="USE_CLASS_TAG" text="{8888888, 1102}" comment="Add Class tag?" type="bool" default="if global.$UseClassTagMR? then global.$UseClassTagMR else true"/>
      <param name="USE_TYPE_NAME" text="{8888888, 1103}" comment="Add Type name?" type="bool"  default="if global.$UseTypeNameMR? then global.$UseTypeNameMR else true"/>
      <param name="USE_MODEL_NAME" text="{8888888, 1104}" comment="Add Model name?" type="bool" default="if global.$UseModelNameMR? then global.$UseModelNameMR else true"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="REMOVE_SENTINEL_TAG" text="{8888888, 1105}" comment="Remove Sentinel Tag?" type="bool" default="if global.$RemoveSentinelTagMR? then global.$RemoveSentinelTagMR else false"/>
      <param name="REMOVE_VANGUARD_TAG" text="{8888888, 1106}" comment="Remove Vanguard Tag?" type="bool" default="if global.$RemoveVanguardTagMR? then global.$RemoveVanguardTagMR else false"/>
      <param name="SHORTEN_SENTINEL" text="{8888888, 1107}" comment="Short Sentinel Tag" type="bool" default="if global.$ShortenSentinelMR? then global.$ShortenSentinelMR else true"/>
      <param name="SHORTEN_VANGUARD" text="{8888888, 1108}" comment="Short Vanguard Tag" type="bool" default="if global.$ShortenVanguardMR? then global.$ShortenVanguardMR else true"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- Players own Tag -->
      <param name="TAG_AT_FRONT" text="{8888888, 1109}" comment="Tag at front?" type="bool" default="if global.$TagAtFrontMR? then global.$TagAtFrontMR else true"/>
      <param name="TAG_AT_END" text="{8888888, 1110}" comment="Tag at end?" type="bool" default="if global.$TagAtEndMR? then global.$TagAtEndMR else false"/>
      <param name="TAG_OBJECT" text="{8888888, 1111}" comment="Object with your Tag" type="object" default="if global.$TagObjectMR? then global.$TagObjectMR else this.ship"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- Numbering -->
      <param name="USE_NUMBERING" text="{8888888, 1112}" comment="Use numbering?" type="bool" default="if global.$UseNumberingMR? then global.$UseNumberingMR else true"/>
      <param name="REVERSED_NUMBERING" text="{8888888, 1113}" comment="Sort XL to S?" type="bool" default="if global.$ReversedNumberingMR? then global.$ReversedNumberingMR else false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- Renaming On/Off switch-->
      <param name="RENAME_COMMANDER" text="{8888888, 1114}" comment="Rename Commander?" type="bool" default="if global.$RenameCommanderMR? then global.$RenameCommanderMR else true"/>
      <param name="RENAME_SUBORDINATES" text="{8888888, 1115}" comment="Rename Fleet?" type="bool" default="if global.$RenameSubordinatesMR? then global.$RenameSubordinatesMR else true"/>
      <param name="RENAME_SUBORDINATE_FLEETS" text="{8888888, 1116}" comment="Renam sub. Fleets?" type="bool" default="if global.$RenameSubordinateFleetsMR? then global.$RenameSubordinateFleetsMR else true"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- Coloring of the tag -->
      <param name="USE_TAG_COLORING" text="{8888888, 1117}" comment="Use Tag Coloring?" type="bool" default="if global.$UseTagColoringMR? then global.$UseTagColoringMR else true"/>
      <param name="TAG_ALPHA" text="- {8888888, 1170}" comment="Transparency" type="number" default="if global.$TagAlphaMR? then global.$TagAlphaMR else 255">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_RED" text="- {8888888, 1171}" comment="Red" type="number" default="if global.$TagRedMR? then global.$TagRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_GREEN" text="- {8888888, 1172}" comment="Green" type="number" default="if global.$TagGreenMR? then global.$TagGreenMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_BLUE" text="- {8888888, 1173}" comment="Blue" type="number" default="if global.$TagBlueMR? then global.$TagBlueMR else 102">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- Coloring of the name -->
      <param name="USE_NAME_COLORING" text="{8888888, 1118}" comment="Use Name Coloring?" type="bool" default="if global.$UseNameColoringMR? then global.$UseNameColoringMR else true"/>
      <param name="NAME_ALPHA" text="- {8888888, 1170}" comment="Transparency" type="number" default="if global.$NameAlphaMR? then global.$NameAlphaMR else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NAME_RED" text="- {8888888, 1171}" comment="Red" type="number" default="if global.$NameRedMR? then global.$NameRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NAME_GREEN" text="- {8888888, 1172}" comment="Green" type="number" default="if global.$NameGreenMR? then global.$NameGreenMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NAME_BLUE" text="- {8888888, 1173}" comment="Blue" type="number" default="if global.$NameBlueMR? then global.$NameBlueMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- Coloring of the generated number of numbering -->
      <param name="USE_NUMBER_COLORING" text="{8888888, 1119}" comment="Use Number Coloring?" type="bool" default="if global.$UseNumberColoringMR? then global.$UseNumberColoringMR? else true"/>
      <param name="NUMBER_ALPHA" text="- {8888888, 1170}" comment="Transparency" type="number" default="if global.$NumberAlphaMR? then global.$NumberAlphaMR else 162">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBER_RED" text="- {8888888, 1171}" comment="Red" type="number" default="if global.$NumberRedMR? then global.$NumberRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBER_GREEN" text="- {8888888, 1172}" comment="Green" type="number" default="if global.$NumberGreenMR? then global.$NumberGreenMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBER_BLUE" text="- {8888888, 1173}" comment="Blue" type="number" default="if global.$NumberBlueMR? then global.$NumberBlueMR else 255">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="SAVE_COMMANDERS_NAME" text="{8888888, 1130}" type="bool" default="false"/>
      <param name="SAVE_SUBORDINATES_NAMES" text="{8888888, 1131}" type="bool" default="false"/>
      <param name="SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1132}" type="bool" default="false"/>
      <param name="LOAD_COMMANDERS_NAME" text="{8888888, 1133}" type="bool" default="false"/>
      <param name="LOAD_SUBORDINATES_NAMES" text="{8888888, 1134}" type="bool" default="false"/>
      <param name="LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1135}" type="bool" default="false"/>
      <param name="RESET_COMMANDERS_NAME" text="{8888888, 1136}" type="bool" default="false"/>
      <param name="RESET_SUBORDINATES_NAMES" text="{8888888, 1137}" type="bool" default="false"/>
      <param name="RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1138}" type="bool" default="false"/>
      <param name="DELETE_COMMANDERS_NAME" text="{8888888, 1139}" type="bool" default="false"/>
      <param name="DELETE_SUBORDINATES_NAMES" text="{8888888, 1140}" type="bool" default="false"/>
      <param name="DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1141}" type="bool" default="false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="SAVE_SETTINGS" text="{8888888, 1195}" comment="Save Settings?" type="bool" default="false"/>
      <param name="DELETE_SETTINGS" text="{8888888, 1196}" comment="Delete Settings?" type="bool" default="false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- DEBUG -->
      <param name="DEBUG" text="DebugText" type="number" default="0" advanced="true">
        <input_param name="min" value="0"/>
        <input_param name="max" value="100"/>
        <input_param name="step" value="100"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    </params>
    <skill min="0"/>
    <requires>
      <match shiptype="shiptype.lasertower" negate="true"/>
    </requires>
  </order>

  <interrupts>
    <handler ref="SectorChangeHandler"/>
    <handler ref="TargetInvalidHandler"/>
    <handler ref="AttackHandler"/>
    <handler ref="MissileLockHandler" />
    <handler ref="ScannedHandler"/>
    <handler ref="InspectedHandler"/>
    <handler ref="FoundAbandonedHandler"/>
    <handler ref="FoundLockboxHandler"/>
    <handler ref="ResupplyHandler"/>
    <handler ref="JobRemoveRequestHandler" />
  </interrupts>

  <init>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <set_value name="$DebugDirectory" exact="'JP_MultiRename.logs'"/>
    <set_value name="$DebugFileName" exact="this.ship.idcode + '.JP_MultiRename.xml.log'"/>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <set_value name="$Commander" exact="this.assignedcontrolled"/>
    <set_value name="$Tag" exact="''"/>
    <set_value name="$NameColorString" exact="''"/>
    <set_value name="$NumberColorString" exact="''"/>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <do_if value="$SAVE_SETTINGS">
      <do_if value="not global.$NamingVariantMR? or @global.$NamingVariantMR != $NAMING_VARINAT">
        <set_value name="global.$NamingVariantMR" exact="$NAMING_VARINAT"/>
      </do_if>
      <do_if value="not global.$UseClassTagMR? or @global.$UseClassTagMR != $USE_CLASS_TAG">
        <set_value name="global.$UseClassTagMR" exact="$USE_CLASS_TAG"/>
      </do_if>
      <do_if value="not global.$UseTypeNameMR? or @global.$UseTypeNameMR != $USE_TYPE_NAME">
        <set_value name="global.$UseTypeNameMR" exact="$USE_TYPE_NAME"/>
      </do_if>
      <do_if value="not global.$UseModelNameMR? or @global.$UseModelNameMR != $USE_MODEL_NAME">
        <set_value name="global.$UseModelNameMR" exact="$USE_MODEL_NAME"/>
      </do_if>
      <do_if value="not global.$RemoveSentinelTagMR? or @global.$RemoveSentinelTagMR != $REMOVE_SENTINEL_TAG">
        <set_value name="global.$RemoveSentinelTagMR" exact="$REMOVE_SENTINEL_TAG"/>
      </do_if>
      <do_if value="not global.$RemoveVanguardTagMR? or @global.$RemoveVanguardTagMR != $REMOVE_VANGUARD_TAG">
        <set_value name="global.$RemoveVanguardTagMR" exact="$REMOVE_VANGUARD_TAG"/>
      </do_if>
      <do_if value="not global.$ShortenSentinelMR? or @global.$ShortenSentinelMR != $SHORTEN_SENTINEL">
        <set_value name="global.$ShortenSentinelMR" exact="$SHORTEN_SENTINEL"/>
      </do_if>
      <do_if value="not global.$ShortenVanguardMR? or @global.$ShortenVanguardMR != $SHORTEN_VANGUARD">
        <set_value name="global.$ShortenVanguardMR" exact="$SHORTEN_VANGUARD"/>
      </do_if>
      <do_if value="not global.$TagAtFrontMR? or @global.$TagAtFrontMR != $TAG_AT_FRONT">
        <set_value name="global.$TagAtFrontMR" exact="$TAG_AT_FRONT"/>
      </do_if>
      <do_if value="not global.$TagAtEndMR? or @global.$TagAtEndMR != $TAG_AT_END">
        <set_value name="global.$TagAtEndMR" exact="$TAG_AT_END"/>
      </do_if>
      <do_if value="not global.$TagObjectMR? or @global.$TagObjectMR != $TAG_OBJECT">
        <set_value name="global.$TagObjectMR" exact="$TAG_OBJECT"/>
      </do_if>
      <do_if value="not global.$UseNumberingMR? or @global.$UseNumberingMR != $USE_NUMBERING">
        <set_value name="global.$UseNumberingMR" exact="$USE_NUMBERING"/>
      </do_if>
      <do_if value="not global.$ReversedNumberingMR? or @global.$ReversedNumberingMR != $REVERSED_NUMBERING">
        <set_value name="global.$ReversedNumberingMR" exact="$REVERSED_NUMBERING"/>
      </do_if>
      <do_if value="not global.$RenameCommanderMR? or @global.$RenameCommanderMR != $RENAME_COMMANDER">
        <set_value name="global.$RenameCommanderMR" exact="$RENAME_COMMANDER"/>
      </do_if>
      <do_if value="not global.$RenameSubordinatesMR? or @global.$RenameSubordinatesMR != $RENAME_SUBORDINATES">
        <set_value name="global.$RenameSubordinatesMR" exact="$RENAME_SUBORDINATES"/>
      </do_if>
      <do_if value="not global.$RenameSubordinateFleetsMR? or @global.$RenameSubordinateFleetsMR != $RENAME_SUBORDINATE_FLEETS">
        <set_value name="global.$RenameSubordinateFleetsMR" exact="$RENAME_SUBORDINATE_FLEETS"/>
      </do_if>
      <do_if value="not global.$UseTagColoringMR? or @global.$UseTagColoringMR != $USE_TAG_COLORING">
        <set_value name="global.$UseTagColoringMR" exact="$USE_TAG_COLORING"/>
      </do_if>
      <do_if value="not global.$TagAlphaMR? or @global.$TagAlphaMR != $TAG_ALPHA">
        <set_value name="global.$TagAlphaMR" exact="$TAG_ALPHA"/>
      </do_if>
      <do_if value="not global.$TagRedMR? or @global.$TagRedMR != $TAG_RED">
        <set_value name="global.$TagRedMR" exact="$TAG_RED"/>
      </do_if>
      <do_if value="not global.$TagGreenMR? or @global.$TagGreenMR != $TAG_GREEN">
        <set_value name="global.$TagGreenMR" exact="$TAG_GREEN"/>
      </do_if>
      <do_if value="not global.$TagBlueMR? or @global.$TagBlueMR != $TAG_BLUE">
        <set_value name="global.$TagBlueMR" exact="$TAG_BLUE"/>
      </do_if>
      <do_if value="not global.$UseNameColoringMR? or @global.$UseNameColoringMR != $USE_NAME_COLORING">
        <set_value name="global.$UseNameColoringMR" exact="$USE_NAME_COLORING"/>
      </do_if>
      <do_if value="not global.$NameAlphaMR? or @global.$NameAlphaMR != $NAME_ALPHA">
        <set_value name="global.$NameAlphaMR" exact="$NAME_ALPHA"/>
      </do_if>
      <do_if value="not global.$NameRedMR? or @global.$NameRedMR != $NAME_RED">
        <set_value name="global.$NameRedMR" exact="$NAME_RED"/>
      </do_if>
      <do_if value="not global.$NameGreenMR? or @global.$NameGreenMR != $NAME_GREEN">
        <set_value name="global.$NameGreenMR" exact="$NAME_GREEN"/>
      </do_if>
      <do_if value="not global.$NameBlueMR? or @global.$NameBlueMR != $NAME_BLUE">
        <set_value name="global.$NameBlueMR" exact="$NAME_BLUE"/>
      </do_if>
      <do_if value="not global.$UseNumberColoringMR? or @global.$UseNumberColoringMR != $USE_NUMBER_COLORING">
        <set_value name="global.$UseNumberColoringMR" exact="$USE_NUMBER_COLORING"/>
      </do_if>
      <do_if value="not global.$NumberAlphaMR? or @global.$NumberAlphaMR != $NUMBER_ALPHA">
        <set_value name="global.$NumberAlphaMR" exact="$NUMBER_ALPHA"/>
      </do_if>
      <do_if value="not global.$NumberRedMR? or @global.$NumberRedMR != $NUMBER_RED">
        <set_value name="global.$NumberRedMR" exact="$NUMBER_RED"/>
      </do_if>
      <do_if value="not global.$NumberGreenMR? or @global.$NumberGreenMR != $NUMBER_GREEN">
        <set_value name="global.$NumberGreenMR" exact="$NUMBER_GREEN"/>
      </do_if>
      <do_if value="not global.$NumberBlueMR? or @global.$NumberBlueMR != $NUMBER_BLUE">
        <set_value name="global.$NumberBlueMR" exact="$NUMBER_BLUE"/>
      </do_if>
      <do_if value="not global.$DebugMR? or @global.$DebugMR != $DEBUG">
        <set_value name="global.$DebugMR" exact="$DEBUG"/>
      </do_if>
    </do_if>
    <do_if value="$DELETE_SETTINGS">
      <remove_value name="global.$DebugMR"/>
      <remove_value name="global.$NumberBlueMR"/>
      <remove_value name="global.$NumberGreenMR"/>
      <remove_value name="global.$NumberRedMR"/>
      <remove_value name="global.$NumberAlphaMR"/>
      <remove_value name="global.$UseNumberColoringMR"/>
      <remove_value name="global.$NameBlueMR"/>
      <remove_value name="global.$NameGreenMR"/>
      <remove_value name="global.$NameRedMR"/>
      <remove_value name="global.$NameAlphaMR"/>
      <remove_value name="global.$UseNameColoringMR"/>
      <remove_value name="global.$TagBlueMR"/>
      <remove_value name="global.$TagGreenMR"/>
      <remove_value name="global.$TagRedMR"/>
      <remove_value name="global.$TagAlphaMR"/>
      <remove_value name="global.$UseTagColoringMR"/>
      <remove_value name="global.$RenameSubordinateFleetsMR"/>
      <remove_value name="global.$RenameSubordinatesMR"/>
      <remove_value name="global.$RenameCommanderMR"/>
      <remove_value name="global.$ReversedNumberingMR"/>
      <remove_value name="global.$UseNumberingMR"/>
      <remove_value name="global.$TagObjectMR"/>
      <remove_value name="global.$TagAtEndMR"/>
      <remove_value name="global.$TagAtFrontMR"/>
      <remove_value name="global.$ShortenVanguardMR"/>
      <remove_value name="global.$ShortenSentinelMR"/>
      <remove_value name="global.$RemoveVanguardTagMR"/>
      <remove_value name="global.$RemoveSentinelTagMR"/>
      <remove_value name="global.$UseModelNameMR"/>
      <remove_value name="global.$UseTypeNameMR"/>
      <remove_value name="global.$UseClassTagMR"/>
      <remove_value name="global.$NamingVariantMR"/>
      <!-- cancel order because the settings are invalid now -->
      <cancel_order order="this.ship.order"/>
    </do_if>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  </init>

  <attention min="unknown">
    <actions>

      <wait exact="1ms"/>
      <label name="INIT"/>
      <cancel_all_orders object="$Commander"/>

      <do_if value="$DEBUG gt 0">
        <debug_to_file append="false" directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~ JP_MultiRename.xml ~ Started ~~' + '\n'"/>
      </do_if>

      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <!-- remove it in a later version.. give time for deleting this unused chunk of memory -->
      <do_if value="global.$MultiRenameSavedNames?">
        <remove_value name="global.$MultiRenameSavedNames"/>
      </do_if>

      <run_script name="'JP_SaveLoadReset_MR'">
        <param name="SAVE_COMMANDERS_NAME" value="$SAVE_COMMANDERS_NAME"/>
        <param name="SAVE_SUBORDINATES_NAMES" value="$SAVE_SUBORDINATES_NAMES"/>
        <param name="SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="LOAD_COMMANDERS_NAME" value="$LOAD_COMMANDERS_NAME"/>
        <param name="LOAD_SUBORDINATES_NAMES" value="$LOAD_SUBORDINATES_NAMES"/>
        <param name="LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="RESET_COMMANDERS_NAME" value="$RESET_COMMANDERS_NAME"/>
        <param name="RESET_SUBORDINATES_NAMES" value="$RESET_SUBORDINATES_NAMES"/>
        <param name="RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="DELETE_COMMANDERS_NAME" value="$DELETE_COMMANDERS_NAME"/>
        <param name="DELETE_SUBORDINATES_NAMES" value="$DELETE_SUBORDINATES_NAMES"/>
        <param name="DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="DEBUG" value="$DEBUG"/>
      </run_script>

      <!-- Create tag? Colorize it? -->
      <do_if value="$TAG_AT_FRONT or $TAG_AT_END">
        <do_if value="$USE_TAG_COLORING">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$TAG_ALPHA"/>
            <param name="RED" value="$TAG_RED"/>
            <param name="GREEN" value="$TAG_GREEN"/>
            <param name="BLUE" value="$TAG_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_TagColorString"/>
          </run_script>
          <set_value name="$Tag" exact="$_TagColorString + $TAG_OBJECT.knownname + '\033X'"/>
          <remove_value name="$_TagColorString"/>
        </do_if>
        <do_else>
          <set_value name="$Tag" exact="$TAG_OBJECT.knownname"/>
        </do_else>
      </do_if>

      <!-- Colorize name? -->
      <do_if value="$USE_NAME_COLORING">
        <run_script name="'JP_CreateColorString_MR'">
          <param name="ALPHA" value="$NAME_ALPHA"/>
          <param name="RED" value="$NAME_RED"/>
          <param name="GREEN" value="$NAME_GREEN"/>
          <param name="BLUE" value="$NAME_BLUE"/>
          <param name="DEBUG" value="$DEBUG"/>
          <save_retval name="COLOR_STRING" variable="$NameColorString"/>
        </run_script>
      </do_if>

      <!-- Colorize number? -->
      <do_if value="$USE_NUMBER_COLORING">
        <run_script name="'JP_CreateColorString_MR'">
          <param name="ALPHA" value="$NUMBER_ALPHA"/>
          <param name="RED" value="$NUMBER_RED"/>
          <param name="GREEN" value="$NUMBER_GREEN"/>
          <param name="BLUE" value="$NUMBER_BLUE"/>
          <param name="DEBUG" value="$DEBUG"/>
          <save_retval name="COLOR_STRING" variable="$NumberColorString"/>
        </run_script>
      </do_if>

      <!-- Rename Subordinates of subordinated fleets? -->
      <do_if value="not $RENAME_SUBORDINATE_FLEETS">
        <resume label="RENAME_SUBORDINATES_LBL"/>
      </do_if>
      <create_list name="$_SubCommanders"/>
      <do_for_each name="$_Subordinate" in="$Commander.allsubordinates">
        <do_if value="not $_Subordinate.isunit and $_Subordinate.subordinates.count gt 0">
          <append_to_list name="$_SubCommanders" exact="$_Subordinate"/>
        </do_if>
      </do_for_each>
      <do_for_each name="$_SubCommander" in="$_SubCommanders" reverse="true">
        <create_list name="$_Subordinates"/>
        <do_for_each name="$_Subordinate" in="$_SubCommander.subordinates">
          <do_if value="not $_Subordinate.isunit">
            <append_to_list name="$_Subordinates" exact="$_Subordinate"/>
          </do_if>
        </do_for_each>
        <create_list name="$_Groups"/>
        <set_value name="$_GroupID" exact="1"/>
        <do_while value="$_Subordinates.count gt 0">
          <create_list name="$_Group"/>
          <do_for_each name="$_Subordinate" in="$_Subordinates">
            <do_if value="$_Subordinate.subordinategroupid == $_GroupID">
              <append_to_list name="$_Group" exact="$_Subordinate"/>
            </do_if>
          </do_for_each>
          <do_if value="$_Group.count gt 0">
            <append_to_list name="$_Groups" exact="$_Group"/>
            <remove_from_list name="$_Subordinates" list="$_Group"/>
          </do_if>
          <remove_value name="$_Group"/>
          <set_value name="$_GroupID" operation="add" exact="1"/>
          <wait exact="1ms"/>
        </do_while>
        <remove_value name="$_Subordinates"/>
        <do_for_each name="$_Group" in="$_Groups">
          <run_script name="'JP_GetSubsSortedForNumbering_NMS'">
            <param name="SUBORDINATES" value="$_Group"/>
            <param name="REVERSED_NUMBERING" value="$REVERSED_NUMBERING"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="SORTED_SUBORDINATES" variable="$_Group"/>
          </run_script>
          <do_for_each name="$_Ship" in="$_Group" counter="$_it">
            <run_script name="'JP_CreateName_MR'">
              <param name="SHIP" value="$_Ship"/>
              <param name="NAMING_VARINAT" value="$NAMING_VARINAT"/>
              <param name="USE_CLASS_TAG" value="$USE_CLASS_TAG"/>
              <param name="USE_TYPE_NAME" value="$USE_TYPE_NAME"/>
              <param name="USE_MODEL_NAME" value="$USE_MODEL_NAME"/>
              <param name="REMOVE_SENTINEL_TAG" value="$REMOVE_SENTINEL_TAG"/>
              <param name="REMOVE_VANGUARD_TAG" value="$REMOVE_VANGUARD_TAG"/>
              <param name="SHORTEN_SENTINEL" value="$SHORTEN_SENTINEL"/>
              <param name="SHORTEN_VANGUARD" value="$SHORTEN_VANGUARD"/>
              <param name="TAG_AT_END" value="if $TAG_AT_END then $Tag else ''"/>
              <param name="TAG_AT_FRONT" value="if $TAG_AT_FRONT then $Tag else ''"/>
              <param name="NUMBER_TO_ADD" value="if $USE_NUMBERING then $_it else ''"/>
              <param name="NAME_COLOR_STRING" value="$NameColorString"/>
              <param name="NUMBER_COLOR_STRING" value="$NumberColorString"/>
              <param name="DEBUG" value="$DEBUG"/>
              <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
            </run_script>
            <set_object_name object="$_Ship" name="$_CreatedName"/>
            <remove_value name="$_CreatedName"/>
          </do_for_each>
        </do_for_each>
        <remove_value name="$_Groups"/>
      </do_for_each>

      <!-- Rename Subordinates? -->
      <label name="RENAME_SUBORDINATES_LBL"/>
      <do_if value="not $RENAME_SUBORDINATES">
        <resume label="RENAME_COMMANDER_LBL"/>
      </do_if>
      <create_list name="$_Subordinates"/>
      <do_for_each name="$_Subordinate" in="$Commander.subordinates">
        <do_if value="not $_Subordinate.isunit">
          <append_to_list name="$_Subordinates" exact="$_Subordinate"/>
        </do_if>
      </do_for_each>
      <create_list name="$_Groups"/>
      <set_value name="$_GroupID" exact="1"/>
      <do_while value="$_Subordinates.count gt 0">
        <create_list name="$_Group"/>
        <do_for_each name="$_Subordinate" in="$_Subordinates">
          <do_if value="$_Subordinate.subordinategroupid == $_GroupID">
            <append_to_list name="$_Group" exact="$_Subordinate"/>
          </do_if>
        </do_for_each>
        <do_if value="$_Group.count gt 0">
          <append_to_list name="$_Groups" exact="$_Group"/>
          <remove_from_list name="$_Subordinates" list="$_Group"/>
        </do_if>
        <remove_value name="$_Group"/>
        <set_value name="$_GroupID" operation="add" exact="1"/>
        <wait exact="1ms"/>
      </do_while>
      <remove_value name="$_Subordinates"/>
      <do_for_each name="$_Group" in="$_Groups">
        <run_script name="'JP_GetSubsSortedForNumbering_NMS'">
          <param name="SUBORDINATES" value="$_Group"/>
          <param name="REVERSED_NUMBERING" value="$REVERSED_NUMBERING"/>
          <param name="DEBUG" value="$DEBUG"/>
          <save_retval name="SORTED_SUBORDINATES" variable="$_Group"/>
        </run_script>
        <do_for_each name="$_Ship" in="$_Group" counter="$_it">
          <run_script name="'JP_CreateName_MR'">
            <param name="SHIP" value="$_Ship"/>
            <param name="NAMING_VARINAT" value="$NAMING_VARINAT"/>
            <param name="USE_CLASS_TAG" value="$USE_CLASS_TAG"/>
            <param name="USE_TYPE_NAME" value="$USE_TYPE_NAME"/>
            <param name="USE_MODEL_NAME" value="$USE_MODEL_NAME"/>
            <param name="REMOVE_SENTINEL_TAG" value="$REMOVE_SENTINEL_TAG"/>
            <param name="REMOVE_VANGUARD_TAG" value="$REMOVE_VANGUARD_TAG"/>
            <param name="SHORTEN_SENTINEL" value="$SHORTEN_SENTINEL"/>
            <param name="SHORTEN_VANGUARD" value="$SHORTEN_VANGUARD"/>
            <param name="TAG_AT_END" value="if $TAG_AT_END then $Tag else ''"/>
            <param name="TAG_AT_FRONT" value="if $TAG_AT_FRONT then $Tag else ''"/>
            <param name="NUMBER_TO_ADD" value="if $USE_NUMBERING then $_it else ''"/>
            <param name="NAME_COLOR_STRING" value="$NameColorString"/>
            <param name="NUMBER_COLOR_STRING" value="$NumberColorString"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
          </run_script>
          <set_object_name object="$_Ship" name="$_CreatedName"/>
          <remove_value name="$_CreatedName"/>
        </do_for_each>
      </do_for_each>
      <remove_value name="$_Groups"/>

      <!-- Rename Commander? -->
      <label name="RENAME_COMMANDER_LBL"/>
      <do_if value="not $RENAME_COMMANDER">
        <resume label="FINISH"/>
      </do_if>
      <run_script name="'JP_CreateName_MR'">
        <param name="SHIP" value="$Commander"/>
        <param name="NAMING_VARINAT" value="$NAMING_VARINAT"/>
        <param name="USE_CLASS_TAG" value="$USE_CLASS_TAG"/>
        <param name="USE_TYPE_NAME" value="$USE_TYPE_NAME"/>
        <param name="USE_MODEL_NAME" value="$USE_MODEL_NAME"/>
        <param name="REMOVE_SENTINEL_TAG" value="$REMOVE_SENTINEL_TAG"/>
        <param name="REMOVE_VANGUARD_TAG" value="$REMOVE_VANGUARD_TAG"/>
        <param name="SHORTEN_SENTINEL" value="$SHORTEN_SENTINEL"/>
        <param name="SHORTEN_VANGUARD" value="$SHORTEN_VANGUARD"/>
        <param name="TAG_AT_END" value="if $TAG_AT_END then $Tag else ''"/>
        <param name="TAG_AT_FRONT" value="if $TAG_AT_FRONT then $Tag else ''"/>
        <param name="NUMBER_TO_ADD" value="''"/>
        <param name="NAME_COLOR_STRING" value="$NameColorString"/>
        <param name="NUMBER_COLOR_STRING" value="$NumberColorString"/>
        <param name="DEBUG" value="$DEBUG"/>
        <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
      </run_script>
      <set_object_name object="$Commander" name="$_CreatedName"/>
      <remove_value name="$_CreatedName"/>
      
      <label name="FINISH"/>

      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <do_if value="$DEBUG gt 0">
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~ JP_MultiRename.xml ~ Finished ~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'"/>
      </do_if>

      <label name="CLEANUP"/>
      <remove_value name="$NumberColorString"/>
      <remove_value name="$NameColorString"/>
      <remove_value name="$Tag"/>
      <remove_value name="$Commander"/>
      <remove_value name="$DebugFileName"/>
      <remove_value name="$DebugDirectory"/>

      <label name="END"/>
      <wait exact="1ms"/>
      <set_order_syncpoint_reached order="this.ship.order"/>
      <cancel_order order="this.ship.order" />

    </actions>
  </attention>

  <on_abort>
  </on_abort>

</aiscript>