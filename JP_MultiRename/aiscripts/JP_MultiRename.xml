<?xml version="1.0" encoding="utf-8"?>

<aiscript name="JP_MultiRename" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="aiscripts.xsd">

  <order id="JP_MultiRename" name="{8888888, 1197}MultiRename{8888888, 1199}" category="navigation" infinite="true">
    <params>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_TAG" text="UseTag" comment="Add Tag?" type="bool" default="if global.$AddTagMR? then global.$AddTagMR else true"/>
      <param name="TAG_POSITION" text="- TagPosition" comment="Tag position" type="number" default="if global.$TagPositionMR? then global.$TagPositionMR else 1">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="TAG_OBJECT" text="- {8888888, 1111}" comment="Object with your Tag" type="object" default="if global.$TagObjectMR? then global.$TagObjectMR else this.ship"/>
      <param name="COLORIZE_TAG" text="- {8888888, 1117}" comment="Colorize Tag?" type="bool" default="if global.$ColorizeTagMR? then global.$ColorizeTagMR else true"/>
      <param name="TAG_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$TagAlphaMR? then global.$TagAlphaMR else 255">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$TagRedMR? then global.$TagRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$TagGreenMR? then global.$TagGreenMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$TagBlueMR? then global.$TagBlueMR else 102">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_CLASS_TAG" text="{8888888, 1102}" comment="Add Class Tag?" type="bool" default="if global.$AddClassTagMR? then global.$AddClassTagMR else true"/>
      <param name="CLASS_TAG_POSITION" text="- ClassTagPosition" comment="Class Tag position" type="number" default="if global.$ClassTagPositionMR? then global.$ClassTagPositionMR else 2">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_CLASS_TAG" text="- {8888888, 1118}" comment="Colorize Class Tag?" type="bool" default="if global.$ColorizeClassTagMR? then global.$ColorizeClassTagMR else true"/>
      <param name="CLASS_TAG_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$ClassTagAlphaMR? then global.$ClassTagAlphaMR else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$ClassTagRedMR? then global.$ClassTagRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$ClassTagGreenMR? then global.$ClassTagGreenMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$ClassTagBlueMR? then global.$ClassTagBlueMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_TYPE_NAME" text="{8888888, 1103}" comment="Add Type name?" type="bool"  default="if global.$AddTypeNameMR? then global.$AddTypeNameMR else true"/>
      <param name="TYPE_NAME_POSITION" text="- TypeNamePosition" comment="Type name position" type="number" default="if global.$TypeNamePositionMR? then global.$TypeNamePositionMR else 3">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_TYPE_NAME" text="- {8888888, 1118}" comment="Colorize type name?" type="bool" default="if global.$ColorizeTypeNameMR? then global.$ColorizeTypeNameMR else true"/>
      <param name="TYPE_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$TypeNameAlphaMR? then global.$TypeNameAlphaMR else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$TypeNameRedMR? then global.$TypeNameRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$TypeNameGreenMR? then global.$TypeNameGreenMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$TypeNameBlueMR? then global.$TypeNameBlueMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_MODEL_NAME" text="{8888888, 1104}" comment="Add Model name?" type="bool" default="if global.$AddModelNameMR? then global.$AddModelNameMR else true"/>
      <param name="MODEL_NAME_POSITION" text="- ModelNamePosition" comment="Model name position" type="number" default="if global.$ModelNamePositionMR? then global.$ModelNamePositionMR else 4">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="REMOVE_SENTINEL_TAG" text="- {8888888, 1105}" comment="Remove Sentinel Tag?" type="bool" default="if global.$RemoveSentinelTagMR? then global.$RemoveSentinelTagMR else false"/>
      <param name="REMOVE_VANGUARD_TAG" text="- {8888888, 1106}" comment="Remove Vanguard Tag?" type="bool" default="if global.$RemoveVanguardTagMR? then global.$RemoveVanguardTagMR else false"/>
      <param name="SHORTEN_SENTINEL" text="- {8888888, 1107}" comment="Short Sentinel Tag" type="bool" default="if global.$ShortenSentinelMR? then global.$ShortenSentinelMR else true"/>
      <param name="SHORTEN_VANGUARD" text="- {8888888, 1108}" comment="Short Vanguard Tag" type="bool" default="if global.$ShortenVanguardMR? then global.$ShortenVanguardMR else true"/>
      <param name="COLORIZE_MODEL_NAME" text="- {8888888, 1118}" comment="Colorize Model name?" type="bool" default="if global.$ColorizeModelNameMR? then global.$ColorizeModelNameMR else true"/>
      <param name="MODEL_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$ModelNameAlphaMR? then global.$ModelNameAlphaMR else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$ModelNameRedMR? then global.$ModelNameRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$ModelNameGreenMR? then global.$ModelNameGreenMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$ModelNameBlueMR? then global.$ModelNameBlueMR else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="USE_NUMBERING" text="{8888888, 1112}" comment="Use numbering?" type="bool" default="if global.$UseNumberingMR? then global.$UseNumberingMR else true"/>
      <param name="NUMBER_POSITION" text="- NumberPosition" comment="Number position" type="number" default="if global.$NumberingPositionMR? then global.$NumberingPositionMR else 5">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="REVERSED_NUMBERING" text="- {8888888, 1113}" comment="Sort XL to S?" type="bool" default="if global.$ReversedNumberingMR? then global.$ReversedNumberingMR else false"/>
      <param name="NUMBER_SURROUNDINGS_TAG" text="- NumberSurroundings" comment="Number surroundings" type="object" default="if global.$NumberSurroundingsTagMR? then global.$NumberSurroundingsTagMR else this.ship"/>
      <param name="COLORIZE_NUMBERING" text="- {8888888, 1119}" comment="Colorize Numbering?" type="bool" default="if global.$ColorizeNumberingMR? then global.$ColorizeNumberingMR else true"/>
      <param name="NUMBERING_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$NumberingAlphaMR? then global.$NumberingAlphaMR else 162">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBERING_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$NumberingRedMR? then global.$NumberingRedMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBERING_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$NumberingGreenMR? then global.$NumberingGreenMR else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBERING_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$NumberingBlueMR? then global.$NumberingBlueMR else 255">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- Renaming On/Off switch-->
      <param name="RENAME_COMMANDER" text="{8888888, 1114}" comment="Rename Commander?" type="bool" default="if global.$RenameCommanderMR? then global.$RenameCommanderMR else true"/>
      <param name="RENAME_SUBORDINATES" text="{8888888, 1115}" comment="Rename Fleet?" type="bool" default="if global.$RenameSubordinatesMR? then global.$RenameSubordinatesMR else true"/>
      <param name="RENAME_SUBORDINATE_FLEETS" text="{8888888, 1116}" comment="Renam sub. Fleets?" type="bool" default="if global.$RenameSubordinateFleetsMR? then global.$RenameSubordinateFleetsMR else true"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="SAVE_COMMANDERS_NAME" text="{8888888, 1130}" type="bool" default="false"/>
      <param name="SAVE_SUBORDINATES_NAMES" text="{8888888, 1131}" type="bool" default="false"/>
      <param name="SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1132}" type="bool" default="false"/>
      <param name="LOAD_COMMANDERS_NAME" text="{8888888, 1133}" type="bool" default="false"/>
      <param name="LOAD_SUBORDINATES_NAMES" text="{8888888, 1134}" type="bool" default="false"/>
      <param name="LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1135}" type="bool" default="false"/>
      <param name="RESET_COMMANDERS_NAME" text="{8888888, 1136}" type="bool" default="false"/>
      <param name="RESET_SUBORDINATES_NAMES" text="{8888888, 1137}" type="bool" default="false"/>
      <param name="RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1138}" type="bool" default="false"/>
      <param name="DELETE_COMMANDERS_NAME" text="{8888888, 1139}" type="bool" default="false"/>
      <param name="DELETE_SUBORDINATES_NAMES" text="{8888888, 1140}" type="bool" default="false"/>
      <param name="DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1141}" type="bool" default="false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="SAVE_SETTINGS" text="{8888888, 1195}" comment="Save Settings?" type="bool" default="false"/>
      <param name="DELETE_SETTINGS" text="{8888888, 1196}" comment="Delete Settings?" type="bool" default="false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- DEBUG -->
      <param name="DEBUG" text="DebugText" type="number" default="if global.$DebugMR? then global.$DebugMR else 0 " advanced="true">
        <input_param name="min" value="0"/>
        <input_param name="max" value="100"/>
        <input_param name="step" value="100"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    </params>
    <skill min="0"/>
    <requires>
      <match shiptype="shiptype.lasertower" negate="true"/>
    </requires>
  </order>

  <interrupts>
    <handler ref="SectorChangeHandler"/>
    <handler ref="TargetInvalidHandler"/>
    <handler ref="AttackHandler"/>
    <handler ref="MissileLockHandler" />
    <handler ref="ScannedHandler"/>
    <handler ref="InspectedHandler"/>
    <handler ref="FoundAbandonedHandler"/>
    <handler ref="FoundLockboxHandler"/>
    <handler ref="ResupplyHandler"/>
    <handler ref="JobRemoveRequestHandler" />
  </interrupts>

  <init>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <set_value name="$DebugDirectory" exact="'JP_MultiRename.logs'"/>
    <set_value name="$DebugFileName" exact="this.ship.idcode + '.JP_MultiRename.xml.log'"/>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <set_value name="$Commander" exact="this.assignedcontrolled"/>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <do_if value="$SAVE_SETTINGS">

      <!-- TAG -->
      <do_if value="not global.$AddTagMR? or @global.$AddTagMR != $ADD_TAG">
        <set_value name="global.$AddTagMR" exact="$ADD_TAG"/>
      </do_if>
      <do_if value="not global.$TagPositionMR? or @global.$TagPositionMR != $TAG_POSITION">
        <set_value name="global.$TagPositionMR" exact="$TAG_POSITION"/>
      </do_if>
      <do_if value="not global.$TagObjectMR? or @global.$TagObjectMR != $TAG_OBJECT">
        <set_value name="global.$TagObjectMR" exact="$TAG_OBJECT"/>
      </do_if>
      <do_if value="not global.$ColorizeTagMR? or @global.$ColorizeTagMR != $COLORIZE_TAG">
        <set_value name="global.$ColorizeTagMR" exact="$COLORIZE_TAG"/>
      </do_if>
      <do_if value="not global.$TagAlphaMR? or @global.$TagAlphaMR != $TAG_ALPHA">
        <set_value name="global.$TagAlphaMR" exact="$TAG_ALPHA"/>
      </do_if>
      <do_if value="not global.$TagRedMR? or @global.$TagRedMR != $TAG_RED">
        <set_value name="global.$TagRedMR" exact="$TAG_RED"/>
      </do_if>
      <do_if value="not global.$TagGreenMR? or @global.$TagGreenMR != $TAG_GREEN">
        <set_value name="global.$TagGreenMR" exact="$TAG_GREEN"/>
      </do_if>
      <do_if value="not global.$TagBlueMR? or @global.$TagBlueMR != $TAG_BLUE">
        <set_value name="global.$TagBlueMR" exact="$TAG_BLUE"/>
      </do_if>

      <!-- CLASS TAG -->
      <do_if value="not global.$AddClassTagMR? or @global.$AddClassTagMR != $ADD_CLASS_TAG">
        <set_value name="global.$AddClassTagMR" exact="$ADD_CLASS_TAG"/>
      </do_if>
      <do_if value="not global.$ClassTagPositionMR? or @global.$ClassTagPositionMR != $CLASS_TAG_POSITION">
        <set_value name="global.$ClassTagPositionMR" exact="$CLASS_TAG_POSITION"/>
      </do_if>
      <do_if value="not global.$ColorizeClassTagMR? or @global.$ColorizeClassTagMR != $COLORIZE_CLASS_TAG">
        <set_value name="global.$ColorizeClassTagMR" exact="$COLORIZE_CLASS_TAG"/>
      </do_if>
      <do_if value="not global.$ClassTagAlphaMR? or @global.$ClassTagAlphaMR != $CLASS_TAG_ALPHA">
        <set_value name="global.$ClassTagAlphaMR" exact="$CLASS_TAG_ALPHA"/>
      </do_if>
      <do_if value="not global.$ClassTagRedMR? or @global.$ClassTagRedMR != $CLASS_TAG_RED">
        <set_value name="global.$ClassTagRedMR" exact="$CLASS_TAG_RED"/>
      </do_if>
      <do_if value="not global.$ClassTagGreenMR? or @global.$ClassTagGreenMR != $CLASS_TAG_GREEN">
        <set_value name="global.$ClassTagGreenMR" exact="$CLASS_TAG_GREEN"/>
      </do_if>
      <do_if value="not global.$ClassTagBlueMR? or @global.$ClassTagBlueMR != $CLASS_TAG_BLUE">
        <set_value name="global.$ClassTagBlueMR" exact="$CLASS_TAG_BLUE"/>
      </do_if>

      <!-- TYPE NAME -->
      <do_if value="not global.$AddTypeNameMR? or @global.$AddTypeNameMR != $ADD_TYPE_NAME">
        <set_value name="global.$AddTypeNameMR" exact="$ADD_TYPE_NAME"/>
      </do_if>
      <do_if value="not global.$TypeNamePositionMR? or @global.$TypeNamePositionMR != $TYPE_NAME_POSITION">
        <set_value name="global.$TypeNamePositionMR" exact="$TYPE_NAME_POSITION"/>
      </do_if>
      <do_if value="not global.$ColorizeTypeNameMR? or @global.$ColorizeTypeNameMR != $COLORIZE_TYPE_NAME">
        <set_value name="global.$ColorizeTypeNameMR" exact="$COLORIZE_TYPE_NAME"/>
      </do_if>
      <do_if value="not global.$TypeNameAlphaMR? or @global.$TypeNameAlphaMR != $TYPE_NAME_ALPHA">
        <set_value name="global.$TypeNameAlphaMR" exact="$TYPE_NAME_ALPHA"/>
      </do_if>
      <do_if value="not global.$TypeNameRedMR? or @global.$TypeNameRedMR != $TYPE_NAME_RED">
        <set_value name="global.$TypeNameRedMR" exact="$TYPE_NAME_RED"/>
      </do_if>
      <do_if value="not global.$TypeNameGreenMR? or @global.$TypeNameGreenMR != $TYPE_NAME_GREEN">
        <set_value name="global.$TypeNameGreenMR" exact="$TYPE_NAME_GREEN"/>
      </do_if>
      <do_if value="not global.$TypeNameBlueMR? or @global.$TypeNameBlueMR != $TYPE_NAME_BLUE">
        <set_value name="global.$TypeNameBlueMR" exact="$TYPE_NAME_BLUE"/>
      </do_if>

      <!-- MODEL NAME -->
      <do_if value="not global.$AddModelNameMR? or @global.$AddModelNameMR != $ADD_MODEL_NAME">
        <set_value name="global.$AddModelNameMR" exact="$ADD_MODEL_NAME"/>
      </do_if>
      <do_if value="not global.$ModelNamePositionMR? or @global.$ModelNamePositionMR != $MODEL_NAME_POSITION">
        <set_value name="global.$ModelNamePositionMR" exact="$MODEL_NAME_POSITION"/>
      </do_if>
      <do_if value="not global.$RemoveSentinelTagMR? or @global.$RemoveSentinelTagMR != $REMOVE_SENTINEL_TAG">
        <set_value name="global.$RemoveSentinelTagMR" exact="$REMOVE_SENTINEL_TAG"/>
      </do_if>
      <do_if value="not global.$RemoveVanguardTagMR? or @global.$RemoveVanguardTagMR != $REMOVE_VANGUARD_TAG">
        <set_value name="global.$RemoveVanguardTagMR" exact="$REMOVE_VANGUARD_TAG"/>
      </do_if>
      <do_if value="not global.$ShortenSentinelMR? or @global.$ShortenSentinelMR != $SHORTEN_SENTINEL">
        <set_value name="global.$ShortenSentinelMR" exact="$SHORTEN_SENTINEL"/>
      </do_if>
      <do_if value="not global.$ShortenVanguardMR? or @global.$ShortenVanguardMR != $SHORTEN_VANGUARD">
        <set_value name="global.$ShortenVanguardMR" exact="$SHORTEN_VANGUARD"/>
      </do_if>
      <do_if value="not global.$ColorizeModelNameMR? or @global.$ColorizeModelNameMR != $COLORIZE_MODEL_NAME">
        <set_value name="global.$ColorizeModelNameMR" exact="$COLORIZE_MODEL_NAME"/>
      </do_if>
      <do_if value="not global.$ModelNameAlphaMR? or @global.$ModelNameAlphaMR != $MODEL_NAME_ALPHA">
        <set_value name="global.$ModelNameAlphaMR" exact="$MODEL_NAME_ALPHA"/>
      </do_if>
      <do_if value="not global.$ModelNameRedMR? or @global.$ModelNameRedMR != $MODEL_NAME_RED">
        <set_value name="global.$ModelNameRedMR" exact="$MODEL_NAME_RED"/>
      </do_if>
      <do_if value="not global.$ModelNameGreenMR? or @global.$ModelNameGreenMR != $MODEL_NAME_GREEN">
        <set_value name="global.$ModelNameGreenMR" exact="$MODEL_NAME_GREEN"/>
      </do_if>
      <do_if value="not global.$ModelNameBlueMR? or @global.$ModelNameBlueMR != $MODEL_NAME_BLUE">
        <set_value name="global.$ModelNameBlueMR" exact="$MODEL_NAME_BLUE"/>
      </do_if>

      <!-- NUMBERING -->
      <do_if value="not global.$UseNumberingMR? or @global.$UseNumberingMR != $USE_NUMBERING">
        <set_value name="global.$UseNumberingMR" exact="$USE_NUMBERING"/>
      </do_if>
      <do_if value="not global.$NumberingPositionMR? or @global.$NumberingPositionMR != $MODEL_NAME_POSITION">
        <set_value name="global.$NumberingPositionMR" exact="$MODEL_NAME_POSITION"/>
      </do_if>
      <do_if value="not global.$ReversedNumberingMR? or @global.$ReversedNumberingMR != $REVERSED_NUMBERING">
        <set_value name="global.$ReversedNumberingMR" exact="$REVERSED_NUMBERING"/>
      </do_if>
      <do_if value="not global.$NumberSurroundingsTagMR? or @global.$NumberSurroundingsTagMR != $NUMBER_SURROUNDINGS_TAG">
        <set_value name="global.$NumberSurroundingsTagMR" exact="$NUMBER_SURROUNDINGS_TAG"/>
      </do_if>
      <do_if value="not global.$ColorizeNumberingMR? or @global.$ColorizeModelNameMR != $COLORIZE_NUMBERING">
        <set_value name="global.$ColorizeNumberingMR" exact="$COLORIZE_NUMBERING"/>
      </do_if>
      <do_if value="not global.$NumberingAlphaMR? or @global.$NumberingAlphaMR != $NUMBERING_ALPHA">
        <set_value name="global.$NumberingAlphaMR" exact="$NUMBERING_ALPHA"/>
      </do_if>
      <do_if value="not global.$NumberingRedMR? or @global.$NumberingRedMR != $NUMBERING_RED">
        <set_value name="global.$NumberingRedMR" exact="$NUMBERING_RED"/>
      </do_if>
      <do_if value="not global.$NumberingGreenMR? or @global.$NumberingGreenMR != $NUMBERING_GREEN">
        <set_value name="global.$NumberingGreenMR" exact="$NUMBERING_GREEN"/>
      </do_if>
      <do_if value="not global.$NumberingBlueMR? or @global.$NumberingBlueMR != $NUMBERING_BLUE">
        <set_value name="global.$NumberingBlueMR" exact="$NUMBERING_BLUE"/>
      </do_if>

      <do_if value="not global.$RenameCommanderMR? or @global.$RenameCommanderMR != $RENAME_COMMANDER">
        <set_value name="global.$RenameCommanderMR" exact="$RENAME_COMMANDER"/>
      </do_if>
      <do_if value="not global.$RenameSubordinatesMR? or @global.$RenameSubordinatesMR != $RENAME_SUBORDINATES">
        <set_value name="global.$RenameSubordinatesMR" exact="$RENAME_SUBORDINATES"/>
      </do_if>
      <do_if value="not global.$RenameSubordinateFleetsMR? or @global.$RenameSubordinateFleetsMR != $RENAME_SUBORDINATE_FLEETS">
        <set_value name="global.$RenameSubordinateFleetsMR" exact="$RENAME_SUBORDINATE_FLEETS"/>
      </do_if>

      <do_if value="not global.$DebugMR? or @global.$DebugMR != $DEBUG">
        <set_value name="global.$DebugMR" exact="$DEBUG"/>
      </do_if>
    </do_if>
    <do_if value="$DELETE_SETTINGS">
      <remove_value name="global.$DebugMR"/>
      <remove_value name="global.$RenameSubordinateFleetsMR"/>
      <remove_value name="global.$RenameSubordinatesMR"/>
      <remove_value name="global.$RenameCommanderMR"/>
      <remove_value name="global.$NumberingBlueMR"/>
      <remove_value name="global.$NumberingGreenMR"/>
      <remove_value name="global.$NumberingRedMR"/>
      <remove_value name="global.$NumberingAlphaMR"/>
      <remove_value name="global.$ColorizeNumberingMR"/>
      <remove_value name="global.$NumberSurroundingsTagMR"/>
      <remove_value name="global.$ReversedNumberingMR"/>
      <remove_value name="global.$NumberingPositionMR"/>
      <remove_value name="global.$UseNumberingMR"/>
      <remove_value name="global.$ModelNameBlueMR"/>
      <remove_value name="global.$ModelNameGreenMR"/>
      <remove_value name="global.$ModelNameRedMR"/>
      <remove_value name="global.$ModelNameAlphaMR"/>
      <remove_value name="global.$ColorizeModelNameMR"/>
      <remove_value name="global.$ShortenVanguardMR"/>
      <remove_value name="global.$ShortenSentinelMR"/>
      <remove_value name="global.$RemoveVanguardTagMR"/>
      <remove_value name="global.$RemoveSentinelTagMR"/>
      <remove_value name="global.$ModelNamePositionMR"/>
      <remove_value name="global.$AddModelNameMR"/>
      <remove_value name="global.$TypeNameBlueMR"/>
      <remove_value name="global.$TypeNameGreenMR"/>
      <remove_value name="global.$TypeNameRedMR"/>
      <remove_value name="global.$TypeNameAlphaMR"/>
      <remove_value name="global.$ColorizeTypeNameMR"/>
      <remove_value name="global.$TypeNamePositionMR"/>
      <remove_value name="global.$AddTypeNameMR"/>
      <remove_value name="global.$ClassTagBlueMR"/>
      <remove_value name="global.$ClassTagGreenMR"/>
      <remove_value name="global.$ClassTagRedMR"/>
      <remove_value name="global.$ClassTagAlphaMR"/>
      <remove_value name="global.$ColorizeClassTagMR"/>
      <remove_value name="global.$ClassTagPositionMR"/>
      <remove_value name="global.$AddClassTagMR"/>
      <remove_value name="global.$TagBlueMR"/>
      <remove_value name="global.$TagGreenMR"/>
      <remove_value name="global.$TagRedMR"/>
      <remove_value name="global.$TagAlphaMR"/>
      <remove_value name="global.$ColorizeTagMR"/>
      <remove_value name="global.$TagObjectMR"/>
      <remove_value name="global.$TagPositionMR"/>
      <remove_value name="global.$AddTagMR"/>
      <!-- cancel order because the settings are invalid now -->
      <cancel_order order="this.ship.order"/>
    </do_if>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  </init>

  <attention min="unknown">
    <actions>

      <wait exact="1ms"/>
      <label name="INIT"/>
      <cancel_all_orders object="$Commander"/>

      <do_if value="$DEBUG gt 0">
        <debug_to_file append="false" directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'[' + player.systemtime.{'%F - %X'} + '] ' + '~~ JP_MultiRename.xml ~ Started ~~' + '\n'"/>
      </do_if>

      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <!-- Remove in one of the next updates.. give time to delete the now unused global variables -->
      <remove_value name="global.$NumberBlueMR"/>
      <remove_value name="global.$NumberGreenMR"/>
      <remove_value name="global.$NumberRedMR"/>
      <remove_value name="global.$NumberAlphaMR"/>
      <remove_value name="global.$UseNumberColoringMR"/>
      <remove_value name="global.$NameBlueMR"/>
      <remove_value name="global.$NameGreenMR"/>
      <remove_value name="global.$NameRedMR"/>
      <remove_value name="global.$NameAlphaMR"/>
      <remove_value name="global.$UseNameColoringMR"/>
      <remove_value name="global.$UseTagColoringMR"/>
      <remove_value name="global.$UseModelNameMR"/>
      <remove_value name="global.$UseTypeNameMR"/>
      <remove_value name="global.$UseClassTagMR"/>
      <remove_value name="global.$NamingVariantMR"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <run_script name="'JP_SaveLoadReset_MR'">
        <param name="SAVE_COMMANDERS_NAME" value="$SAVE_COMMANDERS_NAME"/>
        <param name="SAVE_SUBORDINATES_NAMES" value="$SAVE_SUBORDINATES_NAMES"/>
        <param name="SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="LOAD_COMMANDERS_NAME" value="$LOAD_COMMANDERS_NAME"/>
        <param name="LOAD_SUBORDINATES_NAMES" value="$LOAD_SUBORDINATES_NAMES"/>
        <param name="LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="RESET_COMMANDERS_NAME" value="$RESET_COMMANDERS_NAME"/>
        <param name="RESET_SUBORDINATES_NAMES" value="$RESET_SUBORDINATES_NAMES"/>
        <param name="RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="DELETE_COMMANDERS_NAME" value="$DELETE_COMMANDERS_NAME"/>
        <param name="DELETE_SUBORDINATES_NAMES" value="$DELETE_SUBORDINATES_NAMES"/>
        <param name="DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="DEBUG" value="$DEBUG"/>
      </run_script>

      <create_list name="$NameTilesArrangement"/>
      <do_if value="$ADD_TAG">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_TAG">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$TAG_ALPHA"/>
            <param name="RED" value="$TAG_RED"/>
            <param name="GREEN" value="$TAG_GREEN"/>
            <param name="BLUE" value="$TAG_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <append_to_list name="$NameTilesArrangement" exact="['TAG', $TAG_POSITION, $_ColorString, $TAG_OBJECT.knownname]"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_CLASS_TAG">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_CLASS_TAG">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$CLASS_TAG_ALPHA"/>
            <param name="RED" value="$CLASS_TAG_RED"/>
            <param name="GREEN" value="$CLASS_TAG_GREEN"/>
            <param name="BLUE" value="$CLASS_TAG_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <append_to_list name="$NameTilesArrangement" exact="['CLASS_TAG', $CLASS_TAG_POSITION, $_ColorString]"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_TYPE_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_TYPE_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$TYPE_NAME_ALPHA"/>
            <param name="RED" value="$TYPE_NAME_RED"/>
            <param name="GREEN" value="$TYPE_NAME_GREEN"/>
            <param name="BLUE" value="$TYPE_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <append_to_list name="$NameTilesArrangement" exact="['TYPE_NAME', $TYPE_NAME_POSITION, $_ColorString]"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_MODEL_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_MODEL_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$MODEL_NAME_ALPHA"/>
            <param name="RED" value="$MODEL_NAME_RED"/>
            <param name="GREEN" value="$MODEL_NAME_GREEN"/>
            <param name="BLUE" value="$MODEL_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <append_to_list name="$NameTilesArrangement" exact="['MODEL_NAME', $MODEL_NAME_POSITION, $_ColorString]"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$USE_NUMBERING">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_NUMBERING">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$NUMBERING_ALPHA"/>
            <param name="RED" value="$NUMBERING_RED"/>
            <param name="GREEN" value="$NUMBERING_GREEN"/>
            <param name="BLUE" value="$NUMBERING_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <append_to_list name="$NameTilesArrangement" exact="['NUMBER', $NUMBER_POSITION, $_ColorString, $NUMBER_SURROUNDINGS_TAG.knownname]"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <sort_list list="$NameTilesArrangement" sortbyvalue="loop.element.{2}"/>

      <!-- Rename Subordinates of subordinated fleets? -->
      <do_if value="not $RENAME_SUBORDINATE_FLEETS">
        <resume label="RENAME_SUBORDINATES_LBL"/>
      </do_if>
      <create_list name="$_SubCommanders"/>
      <do_for_each name="$_Subordinate" in="$Commander.allsubordinates">
        <do_if value="not $_Subordinate.isunit and $_Subordinate.subordinates.count gt 0">
          <append_to_list name="$_SubCommanders" exact="$_Subordinate"/>
        </do_if>
      </do_for_each>
      <do_for_each name="$_SubCommander" in="$_SubCommanders" reverse="true">
        <create_list name="$_Subordinates"/>
        <do_for_each name="$_Subordinate" in="$_SubCommander.subordinates">
          <do_if value="not $_Subordinate.isunit">
            <append_to_list name="$_Subordinates" exact="$_Subordinate"/>
          </do_if>
        </do_for_each>
        <create_list name="$_Groups"/>
        <set_value name="$_GroupID" exact="1"/>
        <do_while value="$_Subordinates.count gt 0">
          <create_list name="$_Group"/>
          <do_for_each name="$_Subordinate" in="$_Subordinates">
            <do_if value="$_Subordinate.subordinategroupid == $_GroupID">
              <append_to_list name="$_Group" exact="$_Subordinate"/>
            </do_if>
          </do_for_each>
          <do_if value="$_Group.count gt 0">
            <append_to_list name="$_Groups" exact="$_Group"/>
            <remove_from_list name="$_Subordinates" list="$_Group"/>
          </do_if>
          <remove_value name="$_Group"/>
          <set_value name="$_GroupID" operation="add" exact="1"/>
          <wait exact="1ms"/>
        </do_while>
        <remove_value name="$_Subordinates"/>
        <do_for_each name="$_Group" in="$_Groups">
          <run_script name="'JP_GetSubsSortedForNumbering_MR'">
            <param name="SUBORDINATES" value="$_Group"/>
            <param name="REVERSED_NUMBERING" value="$REVERSED_NUMBERING"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="SORTED_SUBORDINATES" variable="$_Group"/>
          </run_script>
          <do_for_each name="$_Ship" in="$_Group" counter="$_it">
            <run_script name="'JP_CreateName_MR'">
              <param name="SHIP" value="$_Ship"/>
              <param name="NAME_TILES_ARRANGEMENT" value="$NameTilesArrangement"/>
              <param name="REMOVE_SENTINEL_TAG" value="$REMOVE_SENTINEL_TAG"/>
              <param name="REMOVE_VANGUARD_TAG" value="$REMOVE_VANGUARD_TAG"/>
              <param name="SHORTEN_SENTINEL" value="$SHORTEN_SENTINEL"/>
              <param name="SHORTEN_VANGUARD" value="$SHORTEN_VANGUARD"/>
              <param name="NUMBER_TO_ADD" value="if $USE_NUMBERING then $_it else ''"/>
              <param name="DEBUG" value="$DEBUG"/>
              <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
            </run_script>
            <set_object_name object="$_Ship" name="$_CreatedName"/>
            <remove_value name="$_CreatedName"/>
          </do_for_each>
        </do_for_each>
        <remove_value name="$_Groups"/>
      </do_for_each>

      <!-- Rename Subordinates? -->
      <label name="RENAME_SUBORDINATES_LBL"/>
      <do_if value="not $RENAME_SUBORDINATES">
        <resume label="RENAME_COMMANDER_LBL"/>
      </do_if>
      <create_list name="$_Subordinates"/>
      <do_for_each name="$_Subordinate" in="$Commander.subordinates">
        <do_if value="not $_Subordinate.isunit">
          <append_to_list name="$_Subordinates" exact="$_Subordinate"/>
        </do_if>
      </do_for_each>
      <create_list name="$_Groups"/>
      <set_value name="$_GroupID" exact="1"/>
      <do_while value="$_Subordinates.count gt 0">
        <create_list name="$_Group"/>
        <do_for_each name="$_Subordinate" in="$_Subordinates">
          <do_if value="$_Subordinate.subordinategroupid == $_GroupID">
            <append_to_list name="$_Group" exact="$_Subordinate"/>
          </do_if>
        </do_for_each>
        <do_if value="$_Group.count gt 0">
          <append_to_list name="$_Groups" exact="$_Group"/>
          <remove_from_list name="$_Subordinates" list="$_Group"/>
        </do_if>
        <remove_value name="$_Group"/>
        <set_value name="$_GroupID" operation="add" exact="1"/>
        <wait exact="1ms"/>
      </do_while>
      <remove_value name="$_Subordinates"/>
      <do_for_each name="$_Group" in="$_Groups">
        <run_script name="'JP_GetSubsSortedForNumbering_MR'">
          <param name="SUBORDINATES" value="$_Group"/>
          <param name="REVERSED_NUMBERING" value="$REVERSED_NUMBERING"/>
          <param name="DEBUG" value="$DEBUG"/>
          <save_retval name="SORTED_SUBORDINATES" variable="$_Group"/>
        </run_script>
        <do_for_each name="$_Ship" in="$_Group" counter="$_it">
          <run_script name="'JP_CreateName_MR'">
            <param name="SHIP" value="$_Ship"/>
            <param name="NAME_TILES_ARRANGEMENT" value="$NameTilesArrangement"/>
            <param name="REMOVE_SENTINEL_TAG" value="$REMOVE_SENTINEL_TAG"/>
            <param name="REMOVE_VANGUARD_TAG" value="$REMOVE_VANGUARD_TAG"/>
            <param name="SHORTEN_SENTINEL" value="$SHORTEN_SENTINEL"/>
            <param name="SHORTEN_VANGUARD" value="$SHORTEN_VANGUARD"/>
            <param name="NUMBER_TO_ADD" value="if $USE_NUMBERING then $_it else ''"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
          </run_script>
          <set_object_name object="$_Ship" name="$_CreatedName"/>
          <remove_value name="$_CreatedName"/>
        </do_for_each>
      </do_for_each>
      <remove_value name="$_Groups"/>

      <!-- Rename Commander? -->
      <label name="RENAME_COMMANDER_LBL"/>
      <do_if value="not $RENAME_COMMANDER">
        <resume label="FINISH"/>
      </do_if>
      <run_script name="'JP_CreateName_MR'">
        <param name="SHIP" value="$Commander"/>
        <param name="NAME_TILES_ARRANGEMENT" value="$NameTilesArrangement"/>
        <param name="REMOVE_SENTINEL_TAG" value="$REMOVE_SENTINEL_TAG"/>
        <param name="REMOVE_VANGUARD_TAG" value="$REMOVE_VANGUARD_TAG"/>
        <param name="SHORTEN_SENTINEL" value="$SHORTEN_SENTINEL"/>
        <param name="SHORTEN_VANGUARD" value="$SHORTEN_VANGUARD"/>
        <param name="NUMBER_TO_ADD" value="''"/>
        <param name="DEBUG" value="$DEBUG"/>
        <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
      </run_script>
      <set_object_name object="$Commander" name="$_CreatedName"/>
      <remove_value name="$_CreatedName"/>

      <label name="FINISH"/>

      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <do_if value="$DEBUG gt 0">
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'[' + player.systemtime.{'%F - %X'} + '] ' + '~~ JP_MultiRename.xml ~ Finished ~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'"/>
      </do_if>

      <label name="CLEANUP"/>
      <remove_value name="$NameTilesArrangement"/>
      <remove_value name="$Commander"/>
      <remove_value name="$DebugFileName"/>
      <remove_value name="$DebugDirectory"/>

      <label name="END"/>
      <wait exact="1ms"/>
      <set_order_syncpoint_reached order="this.ship.order"/>
      <cancel_order order="this.ship.order" />

    </actions>
  </attention>

  <on_abort>
  </on_abort>

</aiscript>