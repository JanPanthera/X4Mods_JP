<?xml version="1.0" encoding="utf-8"?>

<aiscript name="JP_MultiRename" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="aiscripts.xsd">

  <order id="JP_MultiRename" name="{8888888, 1197}MultiRename{8888888, 1199}" category="navigation" infinite="true">
    <params>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_0000" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <param name="OBJECT" text="Which ship or fleet?" type="object" default="this.ship">
        <input_param name="class" value="[class.ship]"/>
      </param>
      <param name="PLACE_HOLDER_000" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_TAG" text="{8888888, 1100}" comment="Add Tag?" type="bool" default="if global.$SettingsMR.{2}.{1}? and @global.$SettingsMR.{2}.{1} != -1 then global.$SettingsMR.{2}.{1} else true"/>
      <param name="TAG_POSITION" text="- {8888888, 1101}" comment="Tag position" type="number" default="if global.$SettingsMR.{2}.{2}? and @global.$SettingsMR.{2}.{2} != -1 then global.$SettingsMR.{2}.{2} else 1">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_TAG" text="- {8888888, 1102}" comment="Colorize Tag?" type="bool" default="if global.$SettingsMR.{2}.{3}? and @global.$SettingsMR.{2}.{3} != -1 then global.$SettingsMR.{2}.{3} else true"/>
      <param name="TAG_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{2}.{4}? and @global.$SettingsMR.{2}.{4} != -1 then global.$SettingsMR.{2}.{4} else 255">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{2}.{5}? and @global.$SettingsMR.{2}.{5} != -1 then global.$SettingsMR.{2}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{2}.{6}? and @global.$SettingsMR.{2}.{6} != -1 then global.$SettingsMR.{2}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{2}.{7}? and @global.$SettingsMR.{2}.{7} != -1 then global.$SettingsMR.{2}.{7} else 102">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TAG_OBJECT" text="- {8888888, 1103}" comment="Object with Tag" type="object" default="if global.$SettingsMR.{2}.{8}? and @global.$SettingsMR.{2}.{8} != -1 then global.$SettingsMR.{2}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_00" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_CLASS_TAG" text="{8888888, 1104}" comment="Add Class Tag?" type="bool" default="if global.$SettingsMR.{3}.{1}? and @global.$SettingsMR.{3}.{1} != -1 then global.$SettingsMR.{3}.{1} else true"/>
      <param name="CLASS_TAG_POSITION" text="- {8888888, 1105}" comment="Class Tag position" type="number" default="if global.$SettingsMR.{3}.{2}? and @global.$SettingsMR.{3}.{2} != -1 then global.$SettingsMR.{3}.{2} else 2">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_CLASS_TAG" text="- {8888888, 1106}" comment="Colorize Class Tag?" type="bool" default="if global.$SettingsMR.{3}.{3}? and @global.$SettingsMR.{3}.{3} != -1 then global.$SettingsMR.{3}.{3} else true"/>
      <param name="CLASS_TAG_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{3}.{4}? and @global.$SettingsMR.{3}.{4} != -1 then global.$SettingsMR.{3}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{3}.{5}? and @global.$SettingsMR.{3}.{5} != -1 then global.$SettingsMR.{3}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{3}.{6}? and @global.$SettingsMR.{3}.{6} != -1 then global.$SettingsMR.{3}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{3}.{7}? and @global.$SettingsMR.{3}.{7} != -1 then global.$SettingsMR.{3}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="CLASS_TAG_SURROUNDINGS" text="- {8888888, 1107}" comment="Class Tag Surroundings" type="object" default="if global.$SettingsMR.{3}.{8}? and @global.$SettingsMR.{3}.{8} != -1 then global.$SettingsMR.{3}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_01" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_TYPE_NAME" text="{8888888, 1108}" comment="Add Type name?" type="bool"  default="if global.$SettingsMR.{4}.{1}? and @global.$SettingsMR.{4}.{1} != -1 then global.$SettingsMR.{4}.{1} else true"/>
      <param name="TYPE_NAME_POSITION" text="- {8888888, 1109}" comment="Type name position" type="number" default="if global.$SettingsMR.{4}.{2}? and @global.$SettingsMR.{4}.{2} != -1 then global.$SettingsMR.{4}.{2} else 3">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_TYPE_NAME" text="- {8888888, 1110}" comment="Colorize Type name?" type="bool" default="if global.$SettingsMR.{4}.{3}? and @global.$SettingsMR.{4}.{3} != -1 then global.$SettingsMR.{4}.{3} else true"/>
      <param name="TYPE_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{4}.{4}? and @global.$SettingsMR.{4}.{4} != -1 then global.$SettingsMR.{4}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{4}.{5}? and @global.$SettingsMR.{4}.{5} != -1 then global.$SettingsMR.{4}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{4}.{6}? and @global.$SettingsMR.{4}.{6} != -1 then global.$SettingsMR.{4}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{4}.{7}? and @global.$SettingsMR.{4}.{7} != -1 then global.$SettingsMR.{4}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="TYPE_NAME_SURROUNDINGS" text="- {8888888, 1111}" comment="Type name Surroundings" type="object" default="if global.$SettingsMR.{4}.{8}? and @global.$SettingsMR.{4}.{8} != -1 then global.$SettingsMR.{4}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_02" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_MODEL_NAME" text="{8888888, 1112}" comment="Add Model name?" type="bool" default="if global.$SettingsMR.{5}.{1}? and @global.$SettingsMR.{5}.{1} != -1 then global.$SettingsMR.{5}.{1} else true"/>
      <param name="MODEL_NAME_POSITION" text="- {8888888, 1113}" comment="Model name position" type="number" default="if global.$SettingsMR.{5}.{2}? and @global.$SettingsMR.{5}.{2} != -1 then global.$SettingsMR.{5}.{2} else 4">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_MODEL_NAME" text="- {8888888, 1114}" comment="Colorize Model name?" type="bool" default="if global.$SettingsMR.{5}.{3}? and @global.$SettingsMR.{5}.{3} != -1 then global.$SettingsMR.{5}.{3} else true"/>
      <param name="MODEL_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{5}.{4}? and @global.$SettingsMR.{5}.{4} != -1 then global.$SettingsMR.{5}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{5}.{5}? and @global.$SettingsMR.{5}.{5} != -1 then global.$SettingsMR.{5}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{5}.{6}? and @global.$SettingsMR.{5}.{6} != -1 then global.$SettingsMR.{5}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{5}.{7}? and @global.$SettingsMR.{5}.{7} != -1 then global.$SettingsMR.{5}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="MODEL_NAME_SURROUNDINGS" text="- {8888888, 1115}" comment="Model name Surroundings" type="object" default="if global.$SettingsMR.{5}.{8}? and @global.$SettingsMR.{5}.{8} != -1 then global.$SettingsMR.{5}.{8} else null"/>
      <param name="REMOVE_SENTINEL_TAG" text="- {8888888, 1116}" comment="Remove Sentinel Tag?" type="bool" default="if global.$SettingsMR.{5}.{9}? and @global.$SettingsMR.{5}.{9} != -1 then global.$SettingsMR.{5}.{9} else false"/>
      <param name="REMOVE_VANGUARD_TAG" text="- {8888888, 1117}" comment="Remove Vanguard Tag?" type="bool" default="if global.$SettingsMR.{5}.{10}? and @global.$SettingsMR.{5}.{10} != -1 then global.$SettingsMR.{5}.{10} else false"/>
      <param name="SHORTEN_SENTINEL" text="- {8888888, 1118}" comment="Short Sentinel Tag" type="bool" default="if global.$SettingsMR.{5}.{11}? and @global.$SettingsMR.{5}.{11} != -1 then global.$SettingsMR.{5}.{11} else true"/>
      <param name="SHORTEN_VANGUARD" text="- {8888888, 1119}" comment="Short Vanguard Tag" type="bool" default="if global.$SettingsMR.{5}.{12}? and @global.$SettingsMR.{5}.{12} != -1 then global.$SettingsMR.{5}.{12} else true"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_03" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="USE_NUMBERING" text="{8888888, 1120}" comment="Use numbering?" type="bool" default="if global.$SettingsMR.{6}.{1}? and @global.$SettingsMR.{6}.{1} != -1 then global.$SettingsMR.{6}.{1} else true"/>
      <param name="NUMBER_POSITION" text="- {8888888, 1121}" comment="Number position" type="number" default="if global.$SettingsMR.{6}.{2}? and @global.$SettingsMR.{6}.{2} != -1 then global.$SettingsMR.{6}.{2} else 0">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_NUMBERING" text="- {8888888, 1122}" comment="Colorize Numbering?" type="bool" default="if global.$SettingsMR.{6}.{3}? and @global.$SettingsMR.{6}.{3} != -1 then global.$SettingsMR.{6}.{3} else true"/>
      <param name="NUMBERING_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{6}.{4}? and @global.$SettingsMR.{6}.{4} != -1 then global.$SettingsMR.{6}.{4} else 210">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBERING_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{6}.{5}? and @global.$SettingsMR.{6}.{5} != -1 then global.$SettingsMR.{6}.{5} else 40">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBERING_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{6}.{6}? and @global.$SettingsMR.{6}.{6} != -1 then global.$SettingsMR.{6}.{6} else 40">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBERING_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{6}.{7}? and @global.$SettingsMR.{6}.{7} != -1 then global.$SettingsMR.{6}.{7} else 255">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="NUMBER_SURROUNDINGS" text="- {8888888, 1123}" comment="Number Surroundings" type="object" default="if global.$SettingsMR.{6}.{8}? and @global.$SettingsMR.{6}.{8} != -1 then global.$SettingsMR.{6}.{8} else null"/>
      <param name="REVERSED_NUMBERING" text="- {8888888, 1124}" comment="Sort XL to S?" type="bool" default="if global.$SettingsMR.{6}.{9}? and @global.$SettingsMR.{6}.{9} != -1 then global.$SettingsMR.{6}.{9} else false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_04" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_FACTION_NAME" text="{8888888, 1125}" comment="Add Faction name?" type="bool" default="if global.$SettingsMR.{7}.{1}? and @global.$SettingsMR.{7}.{1} != -1 then global.$SettingsMR.{7}.{1} else true"/>
      <param name="FACTION_NAME_POSITION" text="- {8888888, 1126}" comment="Faction name position" type="number" default="if global.$SettingsMR.{7}.{2}? and @global.$SettingsMR.{7}.{2} != -1 then global.$SettingsMR.{7}.{2} else 6">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_FACTION_NAME" text="- {8888888, 1128}" comment="Colorize Faction name?" type="bool" default="if global.$SettingsMR.{7}.{3}? and @global.$SettingsMR.{7}.{3} != -1 then global.$SettingsMR.{7}.{3} else true"/>
      <param name="FACTION_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{7}.{4}? and @global.$SettingsMR.{7}.{4} != -1 then global.$SettingsMR.{7}.{4} else 162">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FACTION_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{7}.{5}? and @global.$SettingsMR.{7}.{5} != -1 then global.$SettingsMR.{7}.{5} else 130">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FACTION_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{7}.{6}? and @global.$SettingsMR.{7}.{6} != -1 then global.$SettingsMR.{7}.{6} else 110">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FACTION_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{7}.{7}? and @global.$SettingsMR.{7}.{7} != -1 then global.$SettingsMR.{7}.{7} else 70">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FACTION_NAME_SURROUNDINGS" text="- {8888888, 1129}" comment="Faction name Surroundings" type="object" default="if global.$SettingsMR.{7}.{8}? and @global.$SettingsMR.{7}.{8} != -1 then global.$SettingsMR.{7}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_05" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_ORDER_NAME" text="{8888888, 1130}" comment="Add Order name?" type="bool" default="if global.$SettingsMR.{8}.{1}? and @global.$SettingsMR.{8}.{1} != -1 then global.$SettingsMR.{8}.{1} else false"/>
      <param name="ORDER_NAME_POSITION" text="- {8888888, 1131}" comment="Order name position" type="number" default="if global.$SettingsMR.{8}.{2}? and @global.$SettingsMR.{8}.{2} != -1 then global.$SettingsMR.{8}.{2} else 6">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_ORDER_NAME" text="- {8888888, 1132}" comment="Colorize Order name?" type="bool" default="if global.$SettingsMR.{8}.{3}? and @global.$SettingsMR.{8}.{3} != -1 then global.$SettingsMR.{8}.{3} else true"/>
      <param name="ORDER_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{8}.{4}? and @global.$SettingsMR.{8}.{4} != -1 then global.$SettingsMR.{8}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ORDER_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{8}.{5}? and @global.$SettingsMR.{8}.{5} != -1 then global.$SettingsMR.{8}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ORDER_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{8}.{6}? and @global.$SettingsMR.{8}.{6} != -1 then global.$SettingsMR.{8}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ORDER_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{8}.{7}? and @global.$SettingsMR.{8}.{7} != -1 then global.$SettingsMR.{8}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ORDER_NAME_SURROUNDINGS" text="- {8888888, 1133}" comment="Order name Surroundings" type="object" default="if global.$SettingsMR.{8}.{8}? and @global.$SettingsMR.{8}.{8} != -1 then global.$SettingsMR.{8}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_06" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_ASSIGNMENT_NAME" text="{8888888, 1134}" comment="Add Assignment name?" type="bool" default="if global.$SettingsMR.{9}.{1}? and @global.$SettingsMR.{9}.{1} != -1 then global.$SettingsMR.{9}.{1} else false"/>
      <param name="ASSIGNMENT_NAME_POSITION" text="- {8888888, 1135}" comment="Assignment name position" type="number" default="if global.$SettingsMR.{9}.{2}? and @global.$SettingsMR.{9}.{2} != -1 then global.$SettingsMR.{9}.{2} else 6">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_ASSIGNMENT_NAME" text="- {8888888, 1136}" comment="Colorize Assignment name?" type="bool" default="if global.$SettingsMR.{9}.{3}? and @global.$SettingsMR.{9}.{3} != -1 then global.$SettingsMR.{9}.{3} else true"/>
      <param name="ASSIGNMENT_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{9}.{4}? and @global.$SettingsMR.{9}.{4} != -1 then global.$SettingsMR.{9}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ASSIGNMENT_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{9}.{5}? and @global.$SettingsMR.{9}.{5} != -1 then global.$SettingsMR.{9}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ASSIGNMENT_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{9}.{6}? and @global.$SettingsMR.{9}.{6} != -1 then global.$SettingsMR.{9}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ASSIGNMENT_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{9}.{7}? and @global.$SettingsMR.{9}.{7} != -1 then global.$SettingsMR.{9}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="ASSIGNMENT_NAME_SURROUNDINGS" text="- {8888888, 1137}" comment="Assignment name Surroundings" type="object" default="if global.$SettingsMR.{9}.{8}? and @global.$SettingsMR.{9}.{8} != -1 then global.$SettingsMR.{9}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_07" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_FLEET_NAME" text="{8888888, 1138}" comment="Add Fleet name?" type="bool" default="if global.$SettingsMR.{10}.{1}? and @global.$SettingsMR.{10}.{1} != -1 then global.$SettingsMR.{10}.{1} else false"/>
      <param name="FLEET_NAME_POSITION" text="- {8888888, 1139}" comment="Fleet name position" type="number" default="if global.$SettingsMR.{10}.{2}? and @global.$SettingsMR.{10}.{2} != -1 then global.$SettingsMR.{10}.{2} else 6">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_FLEET_NAME" text="- {8888888, 1140}" comment="Colorize Fleet name?" type="bool" default="if global.$SettingsMR.{10}.{3}? and @global.$SettingsMR.{10}.{3} != -1 then global.$SettingsMR.{10}.{3} else true"/>
      <param name="FLEET_NAME_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{10}.{4}? and @global.$SettingsMR.{10}.{4} != -1 then global.$SettingsMR.{10}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FLEET_NAME_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{10}.{5}? and @global.$SettingsMR.{10}.{5} != -1 then global.$SettingsMR.{10}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FLEET_NAME_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{10}.{6}? and @global.$SettingsMR.{10}.{6} != -1 then global.$SettingsMR.{10}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FLEET_NAME_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{10}.{7}? and @global.$SettingsMR.{10}.{7} != -1 then global.$SettingsMR.{10}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="FLEET_NAME_SURROUNDINGS" text="- {8888888, 1141}" comment="Fleet name Surroundings" type="object" default="if global.$SettingsMR.{10}.{8}? and @global.$SettingsMR.{10}.{8} != -1 then global.$SettingsMR.{10}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_08" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="ADD_DPS_TAG" text="{8888888, 1142}" comment="Add DPS Tag?" type="bool" default="if global.$SettingsMR.{11}.{1}? and @global.$SettingsMR.{11}.{1} != -1 then global.$SettingsMR.{11}.{1} else false"/>
      <param name="DPS_TAG_POSITION" text="- {8888888, 1143}" comment="DPS Tag position" type="number" default="if global.$SettingsMR.{11}.{2}? and @global.$SettingsMR.{11}.{2} != -1 then global.$SettingsMR.{11}.{2} else 6">
        <input_param name="min" value="0"/>
        <input_param name="max" value="99"/>
        <input_param name="step" value="1"/>
      </param>
      <param name="COLORIZE_DPS_TAG" text="- {8888888, 1144}" comment="Colorize DPS Tag?" type="bool" default="if global.$SettingsMR.{11}.{3}? and @global.$SettingsMR.{11}.{3} != -1 then global.$SettingsMR.{11}.{3} else true"/>
      <param name="DPS_TAG_ALPHA" text=" ~ {8888888, 1170}" comment="Transparency" type="number" default="if global.$SettingsMR.{11}.{4}? and @global.$SettingsMR.{11}.{4} != -1 then global.$SettingsMR.{11}.{4} else 182">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="DPS_TAG_RED" text=" ~ {8888888, 1171}" comment="Red" type="number" default="if global.$SettingsMR.{11}.{5}? and @global.$SettingsMR.{11}.{5} != -1 then global.$SettingsMR.{11}.{5} else 0">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="DPS_TAG_GREEN" text=" ~ {8888888, 1172}" comment="Green" type="number" default="if global.$SettingsMR.{11}.{6}? and @global.$SettingsMR.{11}.{6} != -1 then global.$SettingsMR.{11}.{6} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="DPS_TAG_BLUE" text=" ~ {8888888, 1173}" comment="Blue" type="number" default="if global.$SettingsMR.{11}.{7}? and @global.$SettingsMR.{11}.{7} != -1 then global.$SettingsMR.{11}.{7} else 204">
        <input_param name="step" value="1"/>
        <input_param name="min" value="0"/>
        <input_param name="max" value="255"/>
      </param>
      <param name="DPS_TAG_SURROUNDINGS" text="- {8888888, 1145}" comment="DPS Tag surroundings" type="object" default="if global.$SettingsMR.{11}.{8}? and @global.$SettingsMR.{11}.{8} != -1 then global.$SettingsMR.{11}.{8} else null"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_09" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- Renaming On/Off switch-->
      <param name="RENAME_COMMANDER" text="{8888888, 1146}" comment="Rename Commander?" type="bool" default="if global.$SettingsMR.{1}.{2}? and @global.$SettingsMR.{1}.{2} != -1 then global.$SettingsMR.{1}.{2} else true"/>
      <param name="RENAME_SUBORDINATES" text="{8888888, 1147}" comment="Rename Fleet?" type="bool" default="if global.$SettingsMR.{1}.{3}? and @global.$SettingsMR.{1}.{3} != -1 then global.$SettingsMR.{1}.{3} else true"/>
      <param name="RENAME_SUBORDINATE_FLEETS" text="{8888888, 1148}" comment="Renam sub. Fleets?" type="bool" default="if global.$SettingsMR.{1}.{4}? and @global.$SettingsMR.{1}.{4} != -1 then global.$SettingsMR.{1}.{4} else true"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_10" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="SAVE_COMMANDERS_NAME" text="{8888888, 1150}" type="bool" default="false"/>
      <param name="SAVE_SUBORDINATES_NAMES" text="{8888888, 1151}" type="bool" default="false"/>
      <param name="SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1152}" type="bool" default="false"/>
      <param name="LOAD_COMMANDERS_NAME" text="{8888888, 1153}" type="bool" default="false"/>
      <param name="LOAD_SUBORDINATES_NAMES" text="{8888888, 1154}" type="bool" default="false"/>
      <param name="LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1155}" type="bool" default="false"/>
      <param name="RESET_COMMANDERS_NAME" text="{8888888, 1156}" type="bool" default="false"/>
      <param name="RESET_SUBORDINATES_NAMES" text="{8888888, 1157}" type="bool" default="false"/>
      <param name="RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1158}" type="bool" default="false"/>
      <param name="DELETE_COMMANDERS_NAME" text="{8888888, 1159}" type="bool" default="false"/>
      <param name="DELETE_SUBORDINATES_NAMES" text="{8888888, 1160}" type="bool" default="false"/>
      <param name="DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS" text="{8888888, 1161}" type="bool" default="false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="PLACE_HOLDER_11" text="----------------------------------" type="object" default="null">
        <input_param name="class" value="[]"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <param name="RESET_COLORS" text="{8888888, 1149}" comment="Reset Colors?" type="bool" default="false"/>
      <param name="SAVE_SETTINGS" text="{8888888, 1195}" comment="Save Settings?" type="bool" default="false"/>
      <param name="DELETE_SETTINGS" text="{8888888, 1196}" comment="Delete Settings?" type="bool" default="false"/>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      <!-- DEBUG -->
      <param name="DEBUG" text="DebugText" type="number" default="if global.$SettingsMR.{1}.{1}? and @global.$SettingsMR.{1}.{1} != -1 then global.$SettingsMR.{1}.{1} else 0" advanced="true">
        <input_param name="min" value="0"/>
        <input_param name="max" value="100"/>
        <input_param name="step" value="100"/>
      </param>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    </params>
    <skill min="0"/>
    <requires>
      <match shiptype="shiptype.lasertower" negate="true"/>
    </requires>
  </order>

  <interrupts>
    <handler ref="SectorChangeHandler"/>
    <handler ref="TargetInvalidHandler"/>
    <handler ref="AttackHandler"/>
    <handler ref="MissileLockHandler" />
    <handler ref="ScannedHandler"/>
    <handler ref="InspectedHandler"/>
    <handler ref="FoundAbandonedHandler"/>
    <handler ref="FoundLockboxHandler"/>
    <handler ref="ResupplyHandler"/>
    <handler ref="JobRemoveRequestHandler" />
  </interrupts>

  <init>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <set_value name="$DebugDirectory" exact="'JP_MultiRename.logs'"/>
    <set_value name="$DebugFileName" exact="this.ship.idcode + '.JP_MultiRename.xml.log'"/>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <set_value name="$Commander" exact="$OBJECT"/>
    <!--<set_value name="$Commander" exact="$OBJECT.assignedcontrolled"/>-->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <create_list name="$MiscellaneousSettings"/>
    <append_list_elements name="$MiscellaneousSettings" other="[$DEBUG, $RENAME_COMMANDER, $RENAME_SUBORDINATES, $RENAME_SUBORDINATE_FLEETS]"/>

    <create_list name="$TagSettings"/>
    <append_list_elements name="$TagSettings" other="[$ADD_TAG, $TAG_POSITION, $COLORIZE_TAG, $TAG_ALPHA, $TAG_RED, $TAG_GREEN, $TAG_BLUE, $TAG_OBJECT]"/>

    <create_list name="$ClassTagSettings"/>
    <append_list_elements name="$ClassTagSettings" other="[$ADD_CLASS_TAG, $CLASS_TAG_POSITION, $COLORIZE_CLASS_TAG, $CLASS_TAG_ALPHA, $CLASS_TAG_RED, $CLASS_TAG_GREEN, $CLASS_TAG_BLUE, $CLASS_TAG_SURROUNDINGS]"/>

    <create_list name="$TypeNameSettings"/>
    <append_list_elements name="$TypeNameSettings" other="[$ADD_TYPE_NAME, $TYPE_NAME_POSITION, $COLORIZE_TYPE_NAME, $TYPE_NAME_ALPHA, $TYPE_NAME_RED, $TYPE_NAME_GREEN, $TYPE_NAME_BLUE, $TYPE_NAME_SURROUNDINGS]"/>

    <create_list name="$ModelNameSettings"/>
    <append_list_elements name="$ModelNameSettings" other="[$ADD_MODEL_NAME, $MODEL_NAME_POSITION, $COLORIZE_MODEL_NAME, $MODEL_NAME_ALPHA, $MODEL_NAME_RED, $MODEL_NAME_GREEN, $MODEL_NAME_BLUE, $MODEL_NAME_SURROUNDINGS, $REMOVE_SENTINEL_TAG, $REMOVE_VANGUARD_TAG, $SHORTEN_SENTINEL, $SHORTEN_VANGUARD]"/>

    <create_list name="$NumberingSettings"/>
    <append_list_elements name="$NumberingSettings" other="[$USE_NUMBERING, $NUMBER_POSITION, $COLORIZE_NUMBERING, $NUMBERING_ALPHA, $NUMBERING_RED, $NUMBERING_GREEN, $NUMBERING_BLUE, $NUMBER_SURROUNDINGS, $REVERSED_NUMBERING]"/>

    <create_list name="$FactionNameSettings"/>
    <append_list_elements name="$FactionNameSettings" other="[$ADD_FACTION_NAME, $FACTION_NAME_POSITION, $COLORIZE_FACTION_NAME, $FACTION_NAME_ALPHA, $FACTION_NAME_RED, $FACTION_NAME_GREEN, $FACTION_NAME_BLUE, $FACTION_NAME_SURROUNDINGS]"/>

    <create_list name="$OrderNameSettings"/>
    <append_list_elements name="$OrderNameSettings" other="[$ADD_ORDER_NAME, $ORDER_NAME_POSITION, $COLORIZE_ORDER_NAME, $ORDER_NAME_ALPHA, $ORDER_NAME_RED, $ORDER_NAME_GREEN, $ORDER_NAME_BLUE, $ORDER_NAME_SURROUNDINGS]"/>

    <create_list name="$AssignmentNameSettings"/>
    <append_list_elements name="$AssignmentNameSettings" other="[$ADD_ASSIGNMENT_NAME, $ASSIGNMENT_NAME_POSITION, $COLORIZE_ASSIGNMENT_NAME, $ASSIGNMENT_NAME_ALPHA, $ASSIGNMENT_NAME_RED, $ASSIGNMENT_NAME_GREEN, $ASSIGNMENT_NAME_BLUE, $ASSIGNMENT_NAME_SURROUNDINGS]"/>

    <create_list name="$FleetNameSettings"/>
    <append_list_elements name="$FleetNameSettings" other="[$ADD_FLEET_NAME, $FLEET_NAME_POSITION, $COLORIZE_FLEET_NAME, $FLEET_NAME_ALPHA, $FLEET_NAME_RED, $FLEET_NAME_GREEN, $FLEET_NAME_BLUE, $FLEET_NAME_SURROUNDINGS]"/>

    <create_list name="$DpsTagSettings"/>
    <append_list_elements name="$DpsTagSettings" other="[$ADD_DPS_TAG, $DPS_TAG_POSITION, $COLORIZE_DPS_TAG, $DPS_TAG_ALPHA, $DPS_TAG_RED, $DPS_TAG_GREEN, $DPS_TAG_BLUE, $DPS_TAG_SURROUNDINGS]"/>

    <create_list name="$SettingsMR"/>
    <append_list_elements name="$SettingsMR" other="[$MiscellaneousSettings, $TagSettings, $ClassTagSettings, $TypeNameSettings, $ModelNameSettings, $NumberingSettings, $FactionNameSettings, $OrderNameSettings, $AssignmentNameSettings, $FleetNameSettings, $DpsTagSettings]"/>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <do_if value="$RESET_COLORS">
      <do_for_each in="global.$SettingsMR" counter="$_it">
        <do_for_each in="global.$SettingsMR.{$_it}" counter="$_jt">
          <do_if value="$_jt ge 4 and $_jt le 7">
            <set_value name="global.$SettingsMR.{$_it}.{$_jt}" exact="-1"/>
          </do_if>
        </do_for_each>
      </do_for_each>
      <cancel_order order="this.ship.order"/>
    </do_if>
    <do_if value="$SAVE_SETTINGS">
      <do_if value="not global.$SettingsMR?">
        <create_list name="global.$SettingsMR"/>
        <do_for_each in="$SettingsMR" counter="$_it">
          <append_to_list name="global.$SettingsMR" exact="[]"/>
          <do_for_each in="$SettingsMR.{$_it}">
            <append_to_list name="global.$SettingsMR.{$_it}" exact="null"/>
          </do_for_each>
        </do_for_each>
      </do_if>
      <do_for_each name="$_Settings" in="global.$SettingsMR" counter="$_it">
        <do_if value="$SettingsMR.{$_it} == []">
          <set_value name="global.$SettingsMR.{$_it}" exact="[]"/>
        </do_if>
        <do_else>
          <do_for_each name="$_Setting" in="global.$SettingsMR.{$_it}" counter="$_jt">
            <do_if value="$_Setting != $SettingsMR.{$_it}.{$_jt}">
              <set_value name="global.$SettingsMR.{$_it}.{$_jt}" exact="$SettingsMR.{$_it}.{$_jt}"/>
            </do_if>
          </do_for_each>
        </do_else>
      </do_for_each>
    </do_if>
    <do_if value="$DELETE_SETTINGS">
      <remove_value name="global.$SettingsMR"/>
      <!-- cancel order because the settings are invalid now -->
      <cancel_order order="this.ship.order"/>
    </do_if>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  </init>

  <attention min="unknown">
    <actions>

      <wait exact="1ms"/>
      <label name="INIT"/>
      <cancel_all_orders object="$Commander"/>

      <do_if value="$DEBUG gt 0">
        <debug_to_file append="false" directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'[' + player.systemtime.{'%F - %X'} + '] ' + '~~ JP_MultiRename.xml ~ Started ~~' + '\n'"/>
      </do_if>

      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <do_if value="$DEBUG gt 0">
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'$SettingsMR'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <do_for_each name="$_Setting" in="@$SettingsMR">
          <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="' ~ $_Setting: ' + $_Setting"/>
        </do_for_each>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'global.$SettingsMR'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'"/>
        <do_if value="global.$SettingsMR?">
          <do_for_each name="$_Setting" in="global.$SettingsMR">
            <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="' ~ $_Setting: ' + $_Setting"/>
          </do_for_each>
        </do_if>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'"/>
      </do_if>

      <run_script name="'JP_SaveLoadReset_MR'">
        <param name="SAVE_COMMANDERS_NAME" value="$SAVE_COMMANDERS_NAME"/>
        <param name="SAVE_SUBORDINATES_NAMES" value="$SAVE_SUBORDINATES_NAMES"/>
        <param name="SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$SAVE_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="LOAD_COMMANDERS_NAME" value="$LOAD_COMMANDERS_NAME"/>
        <param name="LOAD_SUBORDINATES_NAMES" value="$LOAD_SUBORDINATES_NAMES"/>
        <param name="LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$LOAD_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="RESET_COMMANDERS_NAME" value="$RESET_COMMANDERS_NAME"/>
        <param name="RESET_SUBORDINATES_NAMES" value="$RESET_SUBORDINATES_NAMES"/>
        <param name="RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$RESET_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="DELETE_COMMANDERS_NAME" value="$DELETE_COMMANDERS_NAME"/>
        <param name="DELETE_SUBORDINATES_NAMES" value="$DELETE_SUBORDINATES_NAMES"/>
        <param name="DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS" value="$DELETE_NAMES_OF_SUBORDINATES_SUB_FLEETS"/>
        <param name="DEBUG" value="$DEBUG"/>
      </run_script>

      <create_list name="$NameTilesArrangement"/>
      <do_if value="$ADD_TAG">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_TAG">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$TAG_ALPHA"/>
            <param name="RED" value="$TAG_RED"/>
            <param name="GREEN" value="$TAG_GREEN"/>
            <param name="BLUE" value="$TAG_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Tag" exact="if @$TAG_OBJECT != null then $TAG_OBJECT.knownname else '[JP]'"/>
        <append_to_list name="$NameTilesArrangement" exact="['TAG', $TAG_POSITION, $_ColorString, $_Tag]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_CLASS_TAG">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_CLASS_TAG">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$CLASS_TAG_ALPHA"/>
            <param name="RED" value="$CLASS_TAG_RED"/>
            <param name="GREEN" value="$CLASS_TAG_GREEN"/>
            <param name="BLUE" value="$CLASS_TAG_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$CLASS_TAG_SURROUNDINGS != null then $CLASS_TAG_SURROUNDINGS.knownname else '~%1~'"/>
        <append_to_list name="$NameTilesArrangement" exact="['CLASS_TAG', $CLASS_TAG_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_TYPE_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_TYPE_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$TYPE_NAME_ALPHA"/>
            <param name="RED" value="$TYPE_NAME_RED"/>
            <param name="GREEN" value="$TYPE_NAME_GREEN"/>
            <param name="BLUE" value="$TYPE_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$TYPE_NAME_SURROUNDINGS != null then $TYPE_NAME_SURROUNDINGS.knownname else '%1'"/>
        <append_to_list name="$NameTilesArrangement" exact="['TYPE_NAME', $TYPE_NAME_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_MODEL_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_MODEL_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$MODEL_NAME_ALPHA"/>
            <param name="RED" value="$MODEL_NAME_RED"/>
            <param name="GREEN" value="$MODEL_NAME_GREEN"/>
            <param name="BLUE" value="$MODEL_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$MODEL_NAME_SURROUNDINGS != null then $MODEL_NAME_SURROUNDINGS.knownname else '%1'"/>
        <append_to_list name="$NameTilesArrangement" exact="['MODEL_NAME', $MODEL_NAME_POSITION, $_ColorString, $_Surroundings, $REMOVE_SENTINEL_TAG, $REMOVE_VANGUARD_TAG, $SHORTEN_SENTINEL, $SHORTEN_VANGUARD]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$USE_NUMBERING">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_NUMBERING">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$NUMBERING_ALPHA"/>
            <param name="RED" value="$NUMBERING_RED"/>
            <param name="GREEN" value="$NUMBERING_GREEN"/>
            <param name="BLUE" value="$NUMBERING_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$NUMBER_SURROUNDINGS != null then $NUMBER_SURROUNDINGS.knownname else '%1 - '"/>
        <append_to_list name="$NameTilesArrangement" exact="['NUMBER', $NUMBER_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_FACTION_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_FACTION_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$FACTION_NAME_ALPHA"/>
            <param name="RED" value="$FACTION_NAME_RED"/>
            <param name="GREEN" value="$FACTION_NAME_GREEN"/>
            <param name="BLUE" value="$FACTION_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$FACTION_NAME_SURROUNDINGS != null then $FACTION_NAME_SURROUNDINGS.knownname else '~ [%1]'"/>
        <append_to_list name="$NameTilesArrangement" exact="['FACTION_NAME', $FACTION_NAME_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_ORDER_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_ORDER_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$ORDER_NAME_ALPHA"/>
            <param name="RED" value="$ORDER_NAME_RED"/>
            <param name="GREEN" value="$ORDER_NAME_GREEN"/>
            <param name="BLUE" value="$ORDER_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$ORDER_NAME_SURROUNDINGS != null then $ORDER_NAME_SURROUNDINGS.knownname else '%1'"/>
        <append_to_list name="$NameTilesArrangement" exact="['ORDER_NAME', $ORDER_NAME_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_ASSIGNMENT_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_ASSIGNMENT_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$ASSIGNMENT_NAME_ALPHA"/>
            <param name="RED" value="$ASSIGNMENT_NAME_RED"/>
            <param name="GREEN" value="$ASSIGNMENT_NAME_GREEN"/>
            <param name="BLUE" value="$ASSIGNMENT_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$ASSIGNMENT_NAME_SURROUNDINGS != null then $ASSIGNMENT_NAME_SURROUNDINGS.knownname else '%1'"/>
        <append_to_list name="$NameTilesArrangement" exact="['ASSIGNMENT_NAME', $ASSIGNMENT_NAME_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_FLEET_NAME">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_FLEET_NAME">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$FLEET_NAME_ALPHA"/>
            <param name="RED" value="$FLEET_NAME_RED"/>
            <param name="GREEN" value="$FLEET_NAME_GREEN"/>
            <param name="BLUE" value="$FLEET_NAME_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$FLEET_NAME_SURROUNDINGS != null then $FLEET_NAME_SURROUNDINGS.knownname else '%1'"/>
        <append_to_list name="$NameTilesArrangement" exact="['FLEET_NAME', $FLEET_NAME_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <do_if value="$ADD_DPS_TAG">
        <set_value name="$_ColorString" exact="''"/>
        <do_if value="$COLORIZE_DPS_TAG">
          <run_script name="'JP_CreateColorString_MR'">
            <param name="ALPHA" value="$DPS_TAG_ALPHA"/>
            <param name="RED" value="$DPS_TAG_RED"/>
            <param name="GREEN" value="$DPS_TAG_GREEN"/>
            <param name="BLUE" value="$DPS_TAG_BLUE"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="COLOR_STRING" variable="$_ColorString"/>
          </run_script>
        </do_if>
        <set_value name="$_Surroundings" exact="if @$DPS_TAG_SURROUNDINGS != null then $DPS_TAG_SURROUNDINGS.knownname else '%1'"/>
        <append_to_list name="$NameTilesArrangement" exact="['DPS_TAG', $DPS_TAG_POSITION, $_ColorString, $_Surroundings]"/>
        <remove_value name="$_Surroundings"/>
        <remove_value name="$_ColorString"/>
      </do_if>

      <sort_list list="$NameTilesArrangement" sortbyvalue="loop.element.{2}"/>

      <!-- Rename Subordinates of subordinated fleets? -->
      <do_if value="not $RENAME_SUBORDINATE_FLEETS">
        <resume label="RENAME_SUBORDINATES_LBL"/>
      </do_if>
      <create_list name="$_SubCommanders"/>
      <do_for_each name="$_Subordinate" in="$Commander.allsubordinates">
        <do_if value="not $_Subordinate.isunit and $_Subordinate.subordinates.count gt 0">
          <append_to_list name="$_SubCommanders" exact="$_Subordinate"/>
        </do_if>
      </do_for_each>
      <do_for_each name="$_SubCommander" in="$_SubCommanders" reverse="true">
        <create_list name="$_Subordinates"/>
        <do_for_each name="$_Subordinate" in="$_SubCommander.subordinates">
          <do_if value="not $_Subordinate.isunit">
            <append_to_list name="$_Subordinates" exact="$_Subordinate"/>
          </do_if>
        </do_for_each>
        <create_list name="$_Groups"/>
        <set_value name="$_GroupID" exact="1"/>
        <do_while value="$_Subordinates.count gt 0">
          <create_list name="$_Group"/>
          <do_for_each name="$_Subordinate" in="$_Subordinates">
            <do_if value="$_Subordinate.subordinategroupid == $_GroupID">
              <append_to_list name="$_Group" exact="$_Subordinate"/>
            </do_if>
          </do_for_each>
          <do_if value="$_Group.count gt 0">
            <append_to_list name="$_Groups" exact="$_Group"/>
            <remove_from_list name="$_Subordinates" list="$_Group"/>
          </do_if>
          <remove_value name="$_Group"/>
          <set_value name="$_GroupID" operation="add" exact="1"/>
          <wait exact="1ms"/>
        </do_while>
        <remove_value name="$_Subordinates"/>
        <do_for_each name="$_Group" in="$_Groups">
          <run_script name="'JP_GetSubsSortedForNumbering_MR'">
            <param name="SUBORDINATES" value="$_Group"/>
            <param name="REVERSED_NUMBERING" value="$REVERSED_NUMBERING"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="SORTED_SUBORDINATES" variable="$_Group"/>
          </run_script>
          <do_for_each name="$_Ship" in="$_Group" counter="$_it">
            <run_script name="'JP_CreateName_MR'">
              <param name="SHIP" value="$_Ship"/>
              <param name="NAME_TILES_ARRANGEMENT" value="$NameTilesArrangement"/>
              <param name="NUMBER_TO_ADD" value="if $USE_NUMBERING then $_it else ''"/>
              <param name="DEBUG" value="$DEBUG"/>
              <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
            </run_script>
            <set_object_name object="$_Ship" name="$_CreatedName"/>
            <remove_value name="$_CreatedName"/>
          </do_for_each>
        </do_for_each>
        <remove_value name="$_Groups"/>
      </do_for_each>

      <!-- Rename Subordinates? -->
      <label name="RENAME_SUBORDINATES_LBL"/>
      <do_if value="not $RENAME_SUBORDINATES">
        <resume label="RENAME_COMMANDER_LBL"/>
      </do_if>
      <create_list name="$_Subordinates"/>
      <do_for_each name="$_Subordinate" in="$Commander.subordinates">
        <do_if value="not $_Subordinate.isunit">
          <append_to_list name="$_Subordinates" exact="$_Subordinate"/>
        </do_if>
      </do_for_each>
      <create_list name="$_Groups"/>
      <set_value name="$_GroupID" exact="1"/>
      <do_while value="$_Subordinates.count gt 0">
        <create_list name="$_Group"/>
        <do_for_each name="$_Subordinate" in="$_Subordinates">
          <do_if value="$_Subordinate.subordinategroupid == $_GroupID">
            <append_to_list name="$_Group" exact="$_Subordinate"/>
          </do_if>
        </do_for_each>
        <do_if value="$_Group.count gt 0">
          <append_to_list name="$_Groups" exact="$_Group"/>
          <remove_from_list name="$_Subordinates" list="$_Group"/>
        </do_if>
        <remove_value name="$_Group"/>
        <set_value name="$_GroupID" operation="add" exact="1"/>
        <wait exact="1ms"/>
      </do_while>
      <remove_value name="$_Subordinates"/>
      <do_for_each name="$_Group" in="$_Groups">
        <run_script name="'JP_GetSubsSortedForNumbering_MR'">
          <param name="SUBORDINATES" value="$_Group"/>
          <param name="REVERSED_NUMBERING" value="$REVERSED_NUMBERING"/>
          <param name="DEBUG" value="$DEBUG"/>
          <save_retval name="SORTED_SUBORDINATES" variable="$_Group"/>
        </run_script>
        <do_for_each name="$_Ship" in="$_Group" counter="$_it">
          <run_script name="'JP_CreateName_MR'">
            <param name="SHIP" value="$_Ship"/>
            <param name="NAME_TILES_ARRANGEMENT" value="$NameTilesArrangement"/>
            <param name="NUMBER_TO_ADD" value="if $USE_NUMBERING then $_it else ''"/>
            <param name="DEBUG" value="$DEBUG"/>
            <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
          </run_script>
          <set_object_name object="$_Ship" name="$_CreatedName"/>
          <remove_value name="$_CreatedName"/>
        </do_for_each>
      </do_for_each>
      <remove_value name="$_Groups"/>

      <!-- Rename Commander? -->
      <label name="RENAME_COMMANDER_LBL"/>
      <do_if value="not $RENAME_COMMANDER">
        <resume label="FINISH"/>
      </do_if>
      <run_script name="'JP_CreateName_MR'">
        <param name="SHIP" value="$Commander"/>
        <param name="NAME_TILES_ARRANGEMENT" value="$NameTilesArrangement"/>
        <param name="NUMBER_TO_ADD" value="''"/>
        <param name="DEBUG" value="$DEBUG"/>
        <save_retval name="CREATED_NAME" variable="$_CreatedName"/>
      </run_script>
      <set_object_name object="$Commander" name="$_CreatedName"/>
      <remove_value name="$_CreatedName"/>

      <label name="FINISH"/>

      <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

      <do_if value="$DEBUG gt 0">
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'[' + player.systemtime.{'%F - %X'} + '] ' + '~~ JP_MultiRename.xml ~ Finished ~~'"/>
        <debug_to_file directory="$DebugDirectory" name="$DebugFileName" text="'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'"/>
      </do_if>

      <label name="CLEANUP"/>
      <remove_value name="$SettingsMR"/>
      <remove_value name="$DpsTagSettings"/>
      <remove_value name="$FleetNameSettings"/>
      <remove_value name="$AssignmentNameSettings"/>
      <remove_value name="$OrderNameSettings"/>
      <remove_value name="$FactionNameSettings"/>
      <remove_value name="$NumberingSettings"/>
      <remove_value name="$ModelNameSettings"/>
      <remove_value name="$TypeNameSettings"/>
      <remove_value name="$ClassTagSettings"/>
      <remove_value name="$TagSettings"/>
      <remove_value name="$MiscellaneousSettings"/>
      <remove_value name="$NameTilesArrangement"/>
      <remove_value name="$Commander"/>
      <remove_value name="$DebugFileName"/>
      <remove_value name="$DebugDirectory"/>

      <label name="END"/>
      <wait exact="1ms"/>
      <set_order_syncpoint_reached order="this.ship.order"/>
      <cancel_order order="this.ship.order" />

    </actions>
  </attention>

  <on_abort>
  </on_abort>

</aiscript>